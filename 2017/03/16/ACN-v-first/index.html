<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>ACN_v_first | PIVIX</title>
  <meta name="description" content="A minimal hexo theme." />
  <meta name="keywords" content="hexo,theme,typescript,otakism,otaku" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="CDQZ 高新2016级ACM模拟赛第一套result 结果如上，因为人数问题，我们队只有两人但规则上允许每人都拥有一台电脑。这次比赛还是蛮有意思的，在过程中能看见其他人的进度对自己也是一种鼓励（特别是看了自己A了四块深绿）。深绿胜者可获得笔记本。。。。（没有电脑）一个。 一共九道题，难度（对于自己来说）F&amp;gt;J&amp;gt;I&amp;gt;C&amp;gt;G&amp;gt;B&amp;gt;A&amp;gt;D&amp;gt;E&amp;gt;H。">
<meta name="keywords" content="ACM">
<meta property="og:type" content="article">
<meta property="og:title" content="ACN_v_first">
<meta property="og:url" content="https://lemonoilP.github.io/2017/03/16/ACN-v-first/index.html">
<meta property="og:site_name" content="PIVIX">
<meta property="og:description" content="CDQZ 高新2016级ACM模拟赛第一套result 结果如上，因为人数问题，我们队只有两人但规则上允许每人都拥有一台电脑。这次比赛还是蛮有意思的，在过程中能看见其他人的进度对自己也是一种鼓励（特别是看了自己A了四块深绿）。深绿胜者可获得笔记本。。。。（没有电脑）一个。 一共九道题，难度（对于自己来说）F&amp;gt;J&amp;gt;I&amp;gt;C&amp;gt;G&amp;gt;B&amp;gt;A&amp;gt;D&amp;gt;E&amp;gt;H。">
<meta property="og:image" content="http://img.blog.csdn.net/20170212204425343?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212210813362?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212210843830?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212210907206?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212211412118?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212211550073?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212211840836?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212212325350?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212212755700?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212213232345?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20170212213306143?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:updated_time" content="2017-03-15T16:56:27.261Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ACN_v_first">
<meta name="twitter:description" content="CDQZ 高新2016级ACM模拟赛第一套result 结果如上，因为人数问题，我们队只有两人但规则上允许每人都拥有一台电脑。这次比赛还是蛮有意思的，在过程中能看见其他人的进度对自己也是一种鼓励（特别是看了自己A了四块深绿）。深绿胜者可获得笔记本。。。。（没有电脑）一个。 一共九道题，难度（对于自己来说）F&amp;gt;J&amp;gt;I&amp;gt;C&amp;gt;G&amp;gt;B&amp;gt;A&amp;gt;D&amp;gt;E&amp;gt;H。">
<meta name="twitter:image" content="http://img.blog.csdn.net/20170212204425343?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
  
  
    <link rel="icon" href="/favicon.png">
  

	<script src="https://use.typekit.net/eyf3hir.js"></script>
  <script>try{Typekit.load({ async: false });}catch(e){}</script>
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
  

</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

  <script>setLoadingBarProgress(20)</script>
  
  <div id="site-wrapper">
    
    <header id="header">
	<div id="header-wrapper" class="clearfix">
		<a id="logo" href="/">
			<img src="/images/logo.png" />
			<span id="site-desc">
			  otaku keeps alive
      </span>
		</a>
		<button id="site-nav-switch">
	    <span class="icon icon-menu"></span>
	  </button>
	</div>
	<aside id="site-menu">
  	<nav>
  		
        <a href="/" class="nav-home nav">
          Home
        </a>
      
        <a href="/about" class="nav-about nav">
          About
        </a>
      
        <a href="/archives" class="nav-archives nav">
          Archives
        </a>
      
    </nav>
	</aside>
</header>
    <script>setLoadingBarProgress(40);</script>
    
    <main id="main" role="main">
      <article id="post-ACN-v-first"
  class="post article white-box article-type-post"
  itemscope itemprop="blogPost">
	<h2 class="title">
  	<a href="/2017/03/16/ACN-v-first/">
    	ACN_v_first
    </a>
  </h2>
	<time>
	  Mar 16, 2017
	</time>
	<section class="content">
  	<div class="article-entry" itemprop="articleBody">
    	<h2 id="CDQZ-高新2016级ACM模拟赛第一套"><a href="#CDQZ-高新2016级ACM模拟赛第一套" class="headerlink" title="CDQZ 高新2016级ACM模拟赛第一套"></a>CDQZ 高新2016级ACM模拟赛第一套</h2><h1 id="result"><a href="#result" class="headerlink" title="result"></a>result</h1><p><img src="http://img.blog.csdn.net/20170212204425343?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>结果如上，因为人数问题，我们队只有两人但规则上允许每人都拥有一台电脑。<br>这次比赛还是蛮有意思的，在过程中能看见其他人的进度对自己也是一种鼓励（特别是看了自己A了四块深绿）。<br>深绿胜者可获得笔记本。。。。（没有电脑）一个。</p>
<p>一共九道题，难度（对于自己来说）F&gt;J&gt;I&gt;C&gt;G&gt;B&gt;A&gt;D&gt;E&gt;H。<br>于是乎我还是按照字典序发题解吧。</p>
<h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p><img src="http://img.blog.csdn.net/20170212210813362?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5900" target="_blank" rel="external">A - QSC and Master HDU - 5900</a></p>
<p>dp题，用dp[[i][j]表示从i到j之间的最优解，转移方程可以这样写<br>当i&gt;=j的时，dp[i][j]=0;<br>当i+1==j且key[i]和key[j]互质时，dp[i][j]=0;<br>当i+1==j且key[i]和key[j]不互质时，dp[i][j]=val[i]+val[j]<br>其他情况为，枚举k从i到j-1, dp[i][j]=max(dp[i][k]+dp[k+1][j]).<br>上面还遗漏了一种情况，就是i+1到j-1之间都可以取，且i和j不互质，这种情况i到j所有的数都可以取。<br>以上就是所有情况，接下来写代码就可以了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">302</span>;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> key[maxn],val[maxn],sum[maxn],dp[maxn][maxn];<span class="comment">//sum为前缀和</span></div><div class="line"><span class="keyword">bool</span> ok[maxn][maxn];</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">readin</span>(<span class="title">T</span> &amp;<span class="title">res</span>) &#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;</div><div class="line">	<span class="keyword">while</span> ((ch=getchar())&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>);</div><div class="line">	res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span> ((ch=getchar())&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)</div><div class="line">	res=ch<span class="number">-48</span>+res*<span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">gcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">long</span> <span class="keyword">long</span> b)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> b==<span class="number">0</span>?a:gcd(b,a%b);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> n,cas;</div><div class="line">	readin(cas);</div><div class="line">	<span class="keyword">while</span> (cas--) &#123;</div><div class="line">		readin(n);</div><div class="line">		sum[<span class="number">0</span>]=<span class="number">0</span>;</div><div class="line">		<span class="built_in">memset</span>(ok,<span class="literal">false</span>,<span class="keyword">sizeof</span>(ok));</div><div class="line">		<span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span>(dp));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) </div><div class="line">			readin(key[i]);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</div><div class="line">			readin(val[i]);</div><div class="line">			sum[i]=sum[i<span class="number">-1</span>]+val[i];</div><div class="line">		&#125;		</div><div class="line"><span class="comment">/*		for (int i=1;i&lt;=n;i++)</span></div><div class="line"><span class="comment">		for (int j=1;j&lt;=n;j++) &#123;</span></div><div class="line"><span class="comment">			if (j&lt;=i) ok[i][j]=false;</span></div><div class="line"><span class="comment">			else if (gcd(key[i],key[j])==1) ok[i][j]=false;</span></div><div class="line"><span class="comment">			else ok[i][j]=true;</span></div><div class="line"><span class="comment">		&#125;*/</span></div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++) &#123;</div><div class="line">			<span class="keyword">if</span> (gcd(key[i],key[j])!=<span class="number">1</span>) ok[i][j]=<span class="literal">true</span>;</div><div class="line">		&#125;					</div><div class="line">  		<span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++) </div><div class="line">		<span class="keyword">if</span> (ok[i][i+<span class="number">1</span>])	dp[i][i+<span class="number">1</span>]=val[i]+val[i+<span class="number">1</span>]; </div><div class="line"><span class="comment">/*		for(int i=1;i&lt;=n;i++)  </span></div><div class="line"><span class="comment">        &#123;  </span></div><div class="line"><span class="comment">            for(int j=1;j&lt;=n;j++)  </span></div><div class="line"><span class="comment">            &#123;  </span></div><div class="line"><span class="comment">                if(j==i+1&amp;&amp;ok[i][j]) dp[i][j]=val[i]+val[j];  </span></div><div class="line"><span class="comment">                else dp[i][j]=0;  </span></div><div class="line"><span class="comment">            &#125;  </span></div><div class="line"><span class="comment">        &#125;*/</span></div><div class="line"><span class="comment">/*		for (register int i=1;i&lt;n;i++)</span></div><div class="line"><span class="comment">		for (register int j=i+1;j&lt;=n;j++)</span></div><div class="line"><span class="comment">		for (register int k=i;k&lt;=j;k++) &#123;*/</span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>;l&lt;=n;l++)  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+l&lt;=n;i++)  </div><div class="line">            &#123;  </div><div class="line">                <span class="keyword">int</span> j=i+l;  </div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=i;k&lt;=j;k++)  </div><div class="line">                &#123;  </div><div class="line">			<span class="keyword">if</span> (ok[i][k]&amp;&amp;dp[i+<span class="number">1</span>][k<span class="number">-1</span>]==sum[k<span class="number">-1</span>]-sum[i])</div><div class="line">				dp[i][j]=max(dp[i][j],dp[i+<span class="number">1</span>][k<span class="number">-1</span>]+val[i]+dp[k+<span class="number">1</span>][j]+val[k]);</div><div class="line">			<span class="comment">//</span></div><div class="line">			<span class="keyword">if</span> (ok[k][j]&amp;&amp;dp[k+<span class="number">1</span>][j<span class="number">-1</span>]==sum[j]-sum[k+<span class="number">1</span>])</div><div class="line">				dp[i][j]=max(dp[i][j],dp[i][k<span class="number">-1</span>]+val[k]+dp[k+<span class="number">1</span>][j<span class="number">-1</span>]+val[j]);</div><div class="line">			<span class="comment">//</span></div><div class="line">			dp[i][j]=max(dp[i][j],dp[i+<span class="number">1</span>][j<span class="number">-1</span>]);</div><div class="line">			dp[i][j]=max(dp[i][j],dp[i+<span class="number">1</span>][j]);</div><div class="line">			dp[i][j]=max(dp[i][j],dp[i][j<span class="number">-1</span>]);</div><div class="line"><span class="comment">//		&#125;</span></div><div class="line">		&#125;&#125;&#125;</div><div class="line">		<span class="built_in">cout</span>&lt;&lt;dp[<span class="number">1</span>][n]&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><p><img src="http://img.blog.csdn.net/20170212210843830?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://codeforces.com/problemset/problem/734/E" target="_blank" rel="external">B - Anton and Tree CodeForces - 734E</a><br>这题考察了树的直径的作用。题意中的paint(v)就是把所有的与v同色的并从这个点到v不经过其他颜色的点都涂成一种颜色，包括v;<br>这样缩点是必然的，用dfs缩点后重构树（可证：重构图必然是树）<br>然后因为paint（v）对所有点有效，我们很容易看出树的直径/2就是答案。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;cstdio&gt;</div><div class="line">#include&lt;cstring&gt;</div><div class="line">#include&lt;string&gt;</div><div class="line">#include&lt;set&gt;</div><div class="line">#include&lt;queue&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;vector&gt;</div><div class="line">#include&lt;cstdlib&gt;</div><div class="line">#include&lt;cmath&gt;</div><div class="line">#include&lt;ctime&gt;</div><div class="line">#include&lt;stack&gt;</div><div class="line">#define rez(i,x,y) for(int i=x;i&gt;=y;i--)</div><div class="line">#define res(i,x,y) for(int i=x;i&lt;=y;i++)</div><div class="line">#define INF 2100000000</div><div class="line">#define LL long long</div><div class="line">#define clr(x)  memset(x,0,sizeof(x))</div><div class="line">using namespace std;</div><div class="line">template&lt;class T&gt;inline void readin(T &amp;res)&#123;</div><div class="line">	static char ch;</div><div class="line">	while((ch=getchar())&gt;&apos;9&apos;||ch&lt;&apos;0&apos;);</div><div class="line">	res=ch-48;</div><div class="line">	while((ch=getchar())&lt;=&apos;9&apos;&amp;&amp;ch&gt;=&apos;0&apos;)</div><div class="line">	res=ch-48+res*10;</div><div class="line">&#125;</div><div class="line">const int maxn = 1e5+7;  </div><div class="line">int c[maxn&lt;&lt;1],d[maxn&lt;&lt;1];  </div><div class="line">vector&lt;int&gt;e[maxn&lt;&lt;1]; </div><div class="line">void dfs(int u,int fa)&#123;  </div><div class="line">    for(register int i=0;i&lt;e[u].size();i++)&#123;  </div><div class="line">        int v=e[u][i];</div><div class="line">        if(v==fa)continue;  </div><div class="line">        d[v]=d[u]+(c[u]^c[v]);  </div><div class="line">        dfs(v,u);  </div><div class="line">    &#125;  </div><div class="line">&#125;  </div><div class="line">int main()&#123;</div><div class="line">    int n;  </div><div class="line">    readin(n);  </div><div class="line">    for(register int i = 1;i&lt;=n;i++) readin(c[i]);  </div><div class="line">    for(register int i = 1;i&lt;=n-1;i++)&#123;  </div><div class="line">        int u,v;</div><div class="line">        readin(u),readin(v);</div><div class="line">        e[u].push_back(v);  </div><div class="line">        e[v].push_back(u);  </div><div class="line">    &#125;</div><div class="line">    int u=1;  </div><div class="line">    dfs(u,-1);</div><div class="line">    int maxlen=d[u];</div><div class="line">    for(register int i = 1;i&lt;=n;i++)  </div><div class="line">        if(d[i]&gt;maxlen)  </div><div class="line">            maxlen=d[i],u=i;</div><div class="line">    memset(d,0,sizeof(d));  </div><div class="line">    dfs(u,-1);</div><div class="line">    maxlen = d[u];</div><div class="line">    for(register int i=1;i&lt;=n;i++)&#123;</div><div class="line">        if(d[i]&gt;maxlen)&#123; </div><div class="line">            maxlen = d[i];  </div><div class="line">            u=i;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    printf(&quot;%d\n&quot;,(d[u]+1)/2);  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="C"><a href="#C" class="headerlink" title="C"></a>C</h1><p><img src="http://img.blog.csdn.net/20170212210907206?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://codeforces.com/problemset/problem/729/C" target="_blank" rel="external">C - Road to Cinema CodeForces - 729C</a></p>
<p>题意：首先给出N，K，S，T分别代表汽车类型数量，加油站数量，路程全程，最大耗时。<br>接着N行，每行给出一种汽车的价格和邮箱容积，最后一行给出K个加油站的位置。<br>汽车每到一个加油站都可以瞬间加满油，汽车有两种行驶方式，高速：一公里一分钟一升油，低速：一公里两分钟一升油。可以在任意时间选择任意一种行驶方式。<br>在小于最大耗时的前提下，选择价格最小的汽车跑完全程。输出最小价格，如果找不到就输出-1.</p>
<p>思路：根据最大耗时可以二分查找出最小油量，根据最小油量去汽车类型中找到最小价格。<br>对于二分过程，设出x1和x2代表高低速所走的路程，解个二元一次方程组即可。这时要处理好边界情况，比如就算全程慢速油料也不够用或者全程高速也用不完油料。实现时我直接忽略掉了x1,x2的中间结果，直接累加的时间<br>注意点一：二分出的结果并不一定合法。需要设置标记变量记录二分过程中是否真的找到过合法的油量，只要找到过一次，就可以拿这个合法的油量去汽车类型中求最小价格，如果一次都找不到，那么二分出的答案本身就不合法，也没必要去汽车类型中找答案了，直接输出-1吧。<br>注意点二：给出的油站位置是乱序的，记得排个序，把起点和终点都当作一个油站会方便运算。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span>* a,<span class="keyword">const</span> <span class="keyword">void</span>* b)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">return</span> (*(<span class="keyword">int</span>*)a-*(<span class="keyword">int</span>*)b);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> c[<span class="number">262144</span>],v[<span class="number">262144</span>],g[<span class="number">262144</span>],px[<span class="number">262144</span>],px2[<span class="number">262144</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span>* a,<span class="keyword">const</span> <span class="keyword">void</span>* b)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> cc=*(<span class="keyword">int</span>*)a,dd=*(<span class="keyword">int</span>*)b;</div><div class="line">	<span class="keyword">return</span> c[cc]-c[dd];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> n,k,s,t;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;n,&amp;k,&amp;s,&amp;t);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;c[i],&amp;v[i]);</div><div class="line">		px[i]=i;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;g[i]);</div><div class="line">	&#125;</div><div class="line">	qsort(g,k,<span class="number">4</span>,&amp;cmp);</div><div class="line">	qsort(px,n,<span class="number">4</span>,&amp;cmp2);</div><div class="line">	g[k]=s;</div><div class="line">	c[n]=<span class="number">-1</span>;</div><div class="line">	px[n]=n;</div><div class="line">	<span class="keyword">int</span> max=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> j=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span>(v[px[i]]&gt;max)</div><div class="line">		&#123;</div><div class="line">			max=v[px[i]];</div><div class="line">			px2[j++]=px[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	px2[j]=n;</div><div class="line">	<span class="keyword">int</span> left=<span class="number">0</span>,right=j;</div><div class="line">	<span class="keyword">while</span>(left&lt;right)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> i=(left+right)&gt;&gt;<span class="number">1</span>;</div><div class="line">		<span class="keyword">int</span> oil=v[px2[i]];</div><div class="line">		<span class="keyword">int</span> j=<span class="number">0</span>;</div><div class="line">		<span class="keyword">int</span> wz=<span class="number">0</span>;</div><div class="line">		<span class="keyword">int</span> tim=<span class="number">0</span>;</div><div class="line">		<span class="keyword">while</span>(<span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span>(tim&gt;t)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(oil&lt;g[j]-wz)</div><div class="line">			&#123;</div><div class="line">				tim=t+<span class="number">1</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">int</span> spd=oil-(g[j]-wz);</div><div class="line">			oil-=spd&lt;&lt;<span class="number">1</span>;</div><div class="line">			<span class="keyword">if</span>(oil&gt;<span class="number">0</span>)</div><div class="line">			&#123;</div><div class="line">				wz+=spd;</div><div class="line">				tim+=spd;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">			&#123;</div><div class="line">				tim+=g[j]-wz;</div><div class="line">				wz=g[j];</div><div class="line">			&#125;</div><div class="line">			tim+=(g[j]-wz)&lt;&lt;<span class="number">1</span>;</div><div class="line">			wz=g[j];</div><div class="line">			oil=v[px2[i]];</div><div class="line">			j++;</div><div class="line">			<span class="keyword">if</span>(j&gt;k)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(tim&lt;=t)</div><div class="line">		&#123;</div><div class="line">			right=i;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			left=i+<span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,c[px2[left]]);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="D"><a href="#D" class="headerlink" title="D"></a>D</h1><p><img src="http://img.blog.csdn.net/20170212211412118?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://codeforces.com/problemset/problem/735/D" target="_blank" rel="external">D - Taxes CodeForces - 735D</a><br><strong>吐槽一下，答案只有1,2,3真的没问题吗？（原因你可以把哥德巴赫猜想给证明一遍。。。。。。）</strong><br>题意：<br>某人要交税，交的税钱是收入n的最大因子（!=n，若该数是质数则是1），但是这人作弊，把钱拆成几份，使交税最少，输出税钱。<br>解法：<br>如果n为质数不拆，<br>如果n是偶数可以拆成两个质数的和。<br>如果n可以拆成2+一个质数输出2<br>剩下的只能成3份。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">readin</span>(<span class="title">T</span> &amp;<span class="title">res</span>) &#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;</div><div class="line">	<span class="keyword">while</span> ((ch=getchar())&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>);</div><div class="line">	res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span> ((ch=getchar())&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)</div><div class="line">	res=ch<span class="number">-48</span>+res*<span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> n;</div><div class="line"><span class="keyword">int</span> prime[<span class="number">60002</span>],sum=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> j,vis[<span class="number">60002</span>];</div><div class="line">	vis[<span class="number">2</span>]=<span class="number">0</span>,vis[<span class="number">3</span>]=<span class="number">0</span>,sum=<span class="number">1</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">60002</span>;i++) &#123;</div><div class="line">		<span class="keyword">if</span> (!vis[i]) &#123;</div><div class="line">			vis[i]=<span class="number">1</span>;</div><div class="line">			prime[sum++]=i;</div><div class="line">			j=<span class="number">2</span>*i;</div><div class="line">			<span class="keyword">while</span> (j&lt;<span class="number">60001</span>) &#123;</div><div class="line">				vis[j]=<span class="number">1</span>;</div><div class="line">				j+=i;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	readin(n);</div><div class="line">	<span class="keyword">int</span> flag1=<span class="number">0</span>,flag2=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span> (n==<span class="number">2</span>) &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">1</span>);</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (n%<span class="number">2</span>==<span class="number">0</span>) &#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">2</span>);</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		init();		</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;prime[i]*prime[i]&lt;=n;i++) &#123;</div><div class="line">			<span class="keyword">if</span> (n%prime[i]==<span class="number">0</span>) &#123;</div><div class="line">				flag1=<span class="number">1</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (flag1) &#123;</div><div class="line">			n-=<span class="number">2</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;prime[i]*prime[i]&lt;=n;i++) &#123;</div><div class="line">				<span class="keyword">if</span> (n%prime[i]==<span class="number">0</span>) &#123;</div><div class="line">					flag2=<span class="number">1</span>;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (flag2) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">3</span>);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">2</span>); </div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="E"><a href="#E" class="headerlink" title="E"></a>E</h1><p><img src="http://img.blog.csdn.net/20170212211550073?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://acm.scu.edu.cn/soj/problem.action?id=4436" target="_blank" rel="external">E - Easy Math SCU - 4436</a><br>一句话：无理数+任意整数数都为无理数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="keyword">int</span> a[<span class="number">131072</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)&gt;<span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> r=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">		&#123;</div><div class="line">			</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">			<span class="keyword">int</span> m=(<span class="keyword">int</span>)<span class="built_in">sqrt</span>(<span class="number">1.0</span>*a[i]+<span class="number">0.5</span>)+<span class="number">1</span>;</div><div class="line">			<span class="keyword">while</span>(r)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">if</span>((<span class="keyword">long</span> <span class="keyword">long</span>)m*m==a[i])</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>((<span class="keyword">long</span> <span class="keyword">long</span>)m*m&lt;a[i])</div><div class="line">				&#123;</div><div class="line">					r=<span class="number">0</span>;</div><div class="line">				&#125;</div><div class="line">				m--;</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(r)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"Yes\n"</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"No\n"</span>);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="F"><a href="#F" class="headerlink" title="F"></a>F</h1><p><img src="http://img.blog.csdn.net/20170212211840836?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5770" target="_blank" rel="external">F - Treasure HDU - 5770</a><br>令subtree(i)表示以i为根节点的子树，对于某个宝箱a,b,v，令c=lca(a,b)<br>1.若a!=c且b!=c，那么要想得到这个宝箱的权值，起点必须在subtree(a)中，终点必须在subtree(b)中<br>2.若a=c，说明b是a的祖先，要想拿到此宝箱，起点不能在subtree(a)中，终点必须在subtree(b)中<br>3.若b=c，与a=c类似，起点不能在subtree(b)中，终点必须在subtree(b)中<br>4.若a=b，说明宝箱和其对应的钥匙在同一点，那么起点和终点只要不同的subtree(son)中即可（son为a的儿子节点）<br>考虑到每种情况起点终点都在某棵子树中任意选取，故首先求出每个节点的dfs序，用dfs序将一棵子树subtree(i)映射成一个连续的区间[l[i],r[i]]，进而上面四种情况中起点和终点的选则就对应二维平面的一个矩阵，平面上点(x,y)的实际意义是走以x为起点y为终点的简单路径能够得到的权值，通过对每个宝箱的讨论可以在平面上扔若干个矩阵，最后从整个平面上找一个点权最大的点即为答案，后者用扫描线加线段树即可（即将一个矩阵看作两条横线，扫到下方横线就权值加v，扫到上方横线就权值减v表示消除影响）<br>注意前三种情况每种情况最多加两个矩阵，但是第四种情况由于起点终点可以在a的若干儿子子树中选取，故最多会出现n^2个矩阵，这显然不行，故可以采取总体累加，局部消除的方法，即先给加一个全平面矩阵，权值为v，然后加所有的不合法矩阵，权值为-v，不非法矩阵有四种情况：<br>1.起点终点都在a的某个subtree(son)中，son为a的儿子节点（累加至多n个）<br>2.起点终点都在suntree(left_brother)中，left_brother为a的左兄弟节点（即dfs序比l[a]小的点)（至多一个）<br>2.起点终点都在suntree(right_brother)中，right_brother为a的右兄弟节点（即dfs序比r[a]大的点)（至多一个）<br>3.起点和终点，一个在suntree(left_brother)中一个在suntree(right_brother)中（至多两个）<br>不合法矩阵累加不超过4*n个，这样就可以保证复杂度是O(nlogn)的了<br>对于上面第一种情况所加矩阵至多n个的解释：虽然每个节点的儿子节点数可以达到n-1个，但是如果将位于同一个节点处的宝箱看作一个来考虑的话，那么每个节点作为其父亲节点的儿子节点在这种情况下被加进去至多一次，故累加不超过n个，这里因为没有这么强的数据所以没有合并宝箱 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rez(i,x,y) for(int i=x;i&gt;=y;i--)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> res(i,x,y) for(int i=x;i&lt;=y;i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 111111</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (t&lt;&lt;1)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (t&lt;&lt;1|1)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x)  memset(x,0,sizeof(x))</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">readin</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>);</div><div class="line">	res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)</div><div class="line">	res=ch<span class="number">-48</span>+res*<span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> y,l,r,v;</div><div class="line">    node()&#123;&#125;;</div><div class="line">    node(<span class="keyword">int</span> _y,<span class="keyword">int</span> _l,<span class="keyword">int</span> _r,<span class="keyword">int</span> _v)&#123;</div><div class="line">        y=_y,l=_l,r=_r,v=_v;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> node &amp;b)<span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> y&lt;b.y;</div><div class="line">    &#125;</div><div class="line">&#125;a[maxn*<span class="number">10</span>];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;g[maxn];</div><div class="line"><span class="keyword">int</span> p[maxn][<span class="number">20</span>],deep[maxn],vis[maxn];</div><div class="line"><span class="keyword">int</span> index,l[maxn],r[maxn];</div><div class="line"><span class="keyword">int</span> T,n,m,res,Case=<span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</div><div class="line">    l[u]=++index;</div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;g[u].size();i++)&#123;</div><div class="line">        <span class="keyword">int</span> v=g[u][i];</div><div class="line">        <span class="keyword">if</span>(vis[v])<span class="keyword">continue</span>;</div><div class="line">        deep[v]=deep[u]+<span class="number">1</span>;</div><div class="line">        p[v][<span class="number">0</span>]=u;</div><div class="line">        dfs(v);</div><div class="line">    &#125;</div><div class="line">    r[u]=index;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(deep[a]&lt;deep[b])swap(a,b);</div><div class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;(<span class="number">1</span>&lt;&lt;i)&lt;=deep[a];i++);</div><div class="line">    i--;</div><div class="line">    <span class="keyword">for</span>(j=i;j&gt;=<span class="number">0</span>;j--)</div><div class="line">        <span class="keyword">if</span>(deep[a]-(<span class="number">1</span>&lt;&lt;j)&gt;=deep[b])</div><div class="line">            a=p[a][j];</div><div class="line">    <span class="keyword">if</span>(a==b) <span class="keyword">return</span> a;</div><div class="line">    <span class="keyword">for</span>(j=i;j&gt;=<span class="number">0</span>;j--)</div><div class="line">        <span class="keyword">if</span>(p[a][j]!=<span class="number">-1</span>&amp;&amp;p[a][j]!=p[b][j])</div><div class="line">            a=p[a][j],b=p[b][j];</div><div class="line">    <span class="keyword">return</span> p[a][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> step)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)</div><div class="line">        <span class="keyword">if</span>(step&amp;(<span class="number">1</span>&lt;&lt;i))x=p[x][i];</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">            <span class="keyword">if</span>(~p[i][j<span class="number">-1</span>])p[i][j]=p[p[i][j<span class="number">-1</span>]][j<span class="number">-1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">deal</span><span class="params">(<span class="keyword">int</span> y1,<span class="keyword">int</span> y2,<span class="keyword">int</span> x1,<span class="keyword">int</span> x2,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    a[res++]=node(y1,x1,x2,v);</div><div class="line">    <span class="keyword">if</span>(y2&lt;n)a[res++]=node(y2+<span class="number">1</span>,x1,x2,-v);</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tree</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> Max,lazy;</div><div class="line">&#125;tree[maxn&lt;&lt;<span class="number">2</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">    tree[t].Max=max(tree[ls].Max,tree[rs].Max);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> lazy=tree[t].lazy;</div><div class="line">    <span class="keyword">if</span>(!lazy)<span class="keyword">return</span> ;</div><div class="line">    tree[ls].Max+=lazy,tree[ls].lazy+=lazy;</div><div class="line">    tree[rs].Max+=lazy,tree[rs].lazy+=lazy;</div><div class="line">    tree[t].lazy=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">    tree[t].Max=tree[t].lazy=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(l==r)<span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">    build(l,mid,ls),build(mid+<span class="number">1</span>,r,rs);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> t,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(l==L&amp;&amp;r==R)&#123;</div><div class="line">        tree[t].Max+=v,tree[t].lazy+=v;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    push_down(t);</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(R&lt;=mid)update(l,mid,L,R,ls,v);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(L&gt;mid)update(mid+<span class="number">1</span>,r,L,R,rs,v);</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        update(l,mid,L,mid,ls,v);</div><div class="line">        update(mid+<span class="number">1</span>,r,mid+<span class="number">1</span>,R,rs,v);</div><div class="line">    &#125;</div><div class="line">    push_up(t);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)g[i].clear();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</div><div class="line">            <span class="keyword">int</span> u,v;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">            g[u].push_back(v),g[v].push_back(u);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">memset</span>(p,<span class="number">-1</span>,<span class="keyword">sizeof</span>(p));</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">        deep[<span class="number">1</span>]=<span class="number">1</span>;index=<span class="number">0</span>;</div><div class="line">        dfs(<span class="number">1</span>);</div><div class="line">        init(n);</div><div class="line">        res=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(m--)&#123;</div><div class="line">            <span class="keyword">int</span> a,b,v;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;v);</div><div class="line">            <span class="keyword">int</span> c=lca(a,b);</div><div class="line">            <span class="keyword">if</span>(a==b)&#123;</div><div class="line">                deal(<span class="number">1</span>,n,<span class="number">1</span>,n,v);</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;g[a].size();i++)&#123;</div><div class="line">                    <span class="keyword">int</span> d=g[a][i];</div><div class="line">                    <span class="keyword">if</span>(deep[d]&lt;deep[a])<span class="keyword">continue</span>;</div><div class="line">                    deal(l[d],r[d],l[d],r[d],-v);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span>(l[a]&gt;<span class="number">1</span>)deal(<span class="number">1</span>,l[a]<span class="number">-1</span>,<span class="number">1</span>,l[a]<span class="number">-1</span>,-v);</div><div class="line">                <span class="keyword">if</span>(r[a]&lt;n)deal(r[a]+<span class="number">1</span>,n,r[a]+<span class="number">1</span>,n,-v);</div><div class="line">                <span class="keyword">if</span>(l[a]&gt;<span class="number">1</span>&amp;&amp;r[a]&lt;n)&#123;</div><div class="line">                    deal(<span class="number">1</span>,l[a]<span class="number">-1</span>,r[a]+<span class="number">1</span>,n,-v);</div><div class="line">                    deal(r[a]+<span class="number">1</span>,n,<span class="number">1</span>,l[a]<span class="number">-1</span>,-v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a!=c&amp;&amp;b!=c)&#123;</div><div class="line">                deal(l[a],r[a],l[b],r[b],v);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a==c)&#123;</div><div class="line">                <span class="keyword">int</span> d=find(b,deep[b]-deep[a]<span class="number">-1</span>);</div><div class="line">                <span class="keyword">if</span>(l[d]&gt;<span class="number">1</span>)deal(<span class="number">1</span>,l[d]<span class="number">-1</span>,l[b],r[b],v);</div><div class="line">                <span class="keyword">if</span>(r[d]&lt;n)deal(r[d]+<span class="number">1</span>,n,l[b],r[b],v);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(b==c)&#123;</div><div class="line">                <span class="keyword">int</span> d=find(a,deep[a]-deep[b]<span class="number">-1</span>);</div><div class="line">                <span class="keyword">if</span>(l[d]&gt;<span class="number">1</span>)deal(l[a],r[a],<span class="number">1</span>,l[d]<span class="number">-1</span>,v);</div><div class="line">                <span class="keyword">if</span>(r[d]&lt;n)deal(l[a],r[a],r[d]+<span class="number">1</span>,n,v);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        sort(a,a+res);</div><div class="line">        <span class="keyword">int</span> ans=-INF;</div><div class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=n;i++)&#123;</div><div class="line">            <span class="keyword">for</span>(;j&lt;res&amp;&amp;a[j].y==i;j++)</div><div class="line">                update(<span class="number">1</span>,n,a[j].l,a[j].r,<span class="number">1</span>,a[j].v);</div><div class="line">            ans=max(ans,tree[<span class="number">1</span>].Max);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>,Case++,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="G"><a href="#G" class="headerlink" title="G"></a>G</h1><p><img src="http://img.blog.csdn.net/20170212212325350?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://codeforces.com/problemset/problem/506/A" target="_blank" rel="external">G - Mr. Kitayuta, the Treasure Hunter CodeForces - 506A</a></p>
<p>一共有30001个岛屿，下标为0~30000，有些岛屿藏有宝藏。你从0往下标大的方向跳，第一步跳的距离为d。如果上一步跳的距离为l，这一步就可以跳l-1或l或l+1（距离必须大于0）。问最多拿到多少宝藏。<br>设dp[i][j]表示到达第i个岛屿，跳了j步得到的最大宝藏数，那么动态转移方程：<br>dp[to][j]=max(dp[to][j],dp[i][j]+treasure[to])<br>dp[to+1][j+1]=max(dp[to+1][j+1],dp[i][j]+treasure[to+1])<br>dp[to-1][j-1]=max(dp[to-1][j-1],dp[i][j]+treasure[to-1])<br>如果开一个dp[30000][30000]的数组的话会MLE，那么在到达30000之前，最大步长是1+2+3+…+250&gt;30000。所以第二维开到500就够了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x) memset(x,0,sizeof(x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ms(a,x) memset(x,a,sizeof(x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> WIN32</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> AUTO <span class="meta-string">"%I64d"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> AUTO <span class="meta-string">"%lld"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">30005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> stp = <span class="number">505</span>;</div><div class="line"><span class="keyword">int</span> n,d,x,ans,maxx;</div><div class="line"><span class="keyword">int</span> num[maxn],sum[maxn];</div><div class="line"><span class="keyword">int</span> dp[maxn][stp];</div><div class="line"><span class="keyword">int</span> sp[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> l)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> sit = pos+l+d;</div><div class="line">    <span class="keyword">if</span>(l+d &lt; <span class="number">1</span> || sit &gt; maxx) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(dp[sit][l+<span class="number">250</span>] != <span class="number">-1</span>) <span class="keyword">return</span> dp[sit][l+<span class="number">250</span>];</div><div class="line">    <span class="keyword">if</span>(l+d &lt;= <span class="number">2</span>) &#123;</div><div class="line">        dp[sit][l+<span class="number">250</span>] = sum[sit];</div><div class="line">        <span class="keyword">return</span> dp[sit][l+<span class="number">250</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(l+d == <span class="number">3</span>) &#123;</div><div class="line">        dp[sit][l+<span class="number">250</span>] = sum[sit+<span class="number">2</span>]+num[sit];</div><div class="line">        <span class="keyword">return</span> dp[sit][l+<span class="number">250</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> he = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</div><div class="line">        <span class="keyword">int</span> xl = l+sp[i];</div><div class="line">        he = max(he, dfs(sit, xl));</div><div class="line">    &#125;</div><div class="line">    he += num[sit];</div><div class="line">    <span class="keyword">return</span> dp[sit][l+<span class="number">250</span>] = he;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">	ms(<span class="number">-1</span>, dp);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;d);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x), maxx = max(x, maxx), num[x]++;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = maxx; i &gt;= <span class="number">1</span>; i--) sum[i] = sum[i+<span class="number">1</span>]+num[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	init();</div><div class="line">    ans = dfs(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="H"><a href="#H" class="headerlink" title="H"></a>H</h1><p><img src="http://img.blog.csdn.net/20170212212755700?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><a href="http://codeforces.com/problemset/problem/555/A" target="_blank" rel="external">H - Case of Matryoshkas CodeForces - 555A</a></p>
<p> 规定两种操作：<br>1、拆下编号最大的娃娃。<br>2、将一条链上的娃娃套在一个没有套在任何其他链子上的娃娃上（有点绕）。意思就是比如有一条链1→2→4→5，你可以拆下5，然后变成两条链1→2→4和5，或者将这条链套在6上，但是6不能已经套在任何其他链子上（即6必须是单独一个），变成1→2→4→5→6。题目要求用最少的操作步数将所有的娃娃套在一个链子上。<br>思       路：  编号为1的娃娃所在的那条链子上，1是不需要拆下来的。也就是不用进行任何操作。如果1套在2上，那么2也不用拆下来，再接着如果2套在3上，那么3也不用拆 ……<br>以此类推，这条链上从1开始连续的数字都是不用拆的。直到某个地方不连续，比如1→2→3→4→6→7→8，其中4套在6上，那么5肯定在别的链子上，需要把6（包括6）以后的所有娃娃都拆下来，然后把5接上去，再把6 7 8接上去。由此看来，这条链上从1开始连续的数字不用拆。一旦遇到不连续，则从这个不连续的娃娃开始后面的全部都要拆。<br> 然后依据要输入几组数据来计算要拆的次数，在计算要套的次数。例如输入n个，m组数据，从一开始连续的用k个，则：<br>    需要次数= 要拆的次数 ( n - k - m + 1 ) + 要套的次数( n - k )<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> a[<span class="number">100005</span>];</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"><span class="keyword">int</span> k;</div><div class="line"><span class="keyword">int</span> cnt;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m)!=EOF) &#123;</div><div class="line">        <span class="keyword">int</span> t = <span class="number">0</span>;</div><div class="line">        cnt = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;m; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</div><div class="line">            <span class="keyword">int</span> flag = <span class="number">0</span>;</div><div class="line">            <span class="keyword">int</span> minn = <span class="number">999999</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;k; j++) &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[j]);</div><div class="line">                <span class="keyword">if</span>(j == <span class="number">0</span> &amp;&amp; a[<span class="number">0</span>] == <span class="number">1</span>) &#123;</div><div class="line">                    flag = <span class="number">1</span>;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(flag == <span class="number">1</span>) &#123;</div><div class="line">                    <span class="keyword">if</span>(a[j] - <span class="number">1</span> != a[j<span class="number">-1</span>]) &#123;</div><div class="line">                        flag = <span class="number">2</span>;</div><div class="line">                        t = a[j<span class="number">-1</span>];</div><div class="line">                        cnt += k - j;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(flag == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">if</span>(a[j]&gt;minn) &#123;</div><div class="line">                        cnt++;</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        minn = a[j];</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(flag == <span class="number">1</span>) &#123;</div><div class="line">                t = a[k<span class="number">-1</span>];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        cnt += n - t;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,cnt);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="I"><a href="#I" class="headerlink" title="I"></a>I</h1><p><img src="http://img.blog.csdn.net/20170212213232345?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5775" target="_blank" rel="external">I - Bubble Sort HDU - 5775</a></p>
<p>题意：给出一个序列，求每一个数字在冒泡排序中出现的最大最小下标差。<br>从小到大考虑每一个数组，一个数字右边有多少个比他大的数字就是他右移的数量。用树状数组维护下就好了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100010</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxm 1000010</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> T,n,cas=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> num[maxn&lt;&lt;<span class="number">1</span>],f[maxn&lt;&lt;<span class="number">1</span>],ans[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;<span class="keyword">return</span> x&amp;(-x);&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">while</span>(x&lt;=n)&#123;</div><div class="line">        f[x]++;</div><div class="line">        x+=lowbit(x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> t=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(x!=<span class="number">0</span>)&#123;</div><div class="line">        t+=f[x];</div><div class="line">        x-=lowbit(x);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> t;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;num[i]);</div><div class="line">        <span class="keyword">int</span> cnt=<span class="number">0</span>,l=<span class="number">0</span>,r=<span class="number">0</span>,nx=<span class="number">0</span>,minn=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">            update(num[i]);</div><div class="line">            nx=i-Sum(num[i]);</div><div class="line">            minn=num[i]+nx-i;</div><div class="line">            l=min(i,num[i]);</div><div class="line">            r=max(i,i+minn);</div><div class="line">            ans[num[i]]=<span class="built_in">abs</span>(r-l);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:"</span>,++cas);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">printf</span>(<span class="string">" %d"</span>,ans[i]);</div><div class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="J"><a href="#J" class="headerlink" title="J"></a>J</h1><p><img src="http://img.blog.csdn.net/20170212213306143?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><a href="https://hihocoder.com/problemset/problem/1391" target="_blank" rel="external">J - Countries HihoCoder - 1391</a></p>
<p>题目大意：<br>　　A和B两个国家互射导弹，每个国家都有一个防御系统，在防御系统开启的时间内可以将到达本国的导弹反弹回去(掉头，防御系统不能开开关关)。<br>　　现在已知：Ta、Tb为A、B两国导弹防御能开启的持续时间，X为B国开启导弹防御系统的时刻(持续时间为[X,Tb+X]，包含端点)<br>　　A向B发射N枚导弹，B向A发射M枚导弹。每枚导弹有3个值：发射时间，从A到B或从B到A的飞行时间，伤害值。<br>　　现在A可以在任意时刻开启防御系统，求A所受到的最小伤害值。<br>题目思路：<br>　　【预处理+排序+堆】<br>　　首先预处理，求出每枚导弹不会打到A需要A国防御系统开启的时间段[st,et]，只有A开启防御的时间段[Y,Y+Ta]包含[st,et]那么这枚导弹不会打到A。<br>　　预处理之后将每枚导弹按照et从小到大排序。<br>　　从1到n+m枚导弹，对于当前这枚导弹，如果需要被防御，那么A防御系统的结束时间就为et，那么开启时间就为et-Ta<br>　　那么将之前已经被防御的导弹中st&lt;et-Ta的移除出去，表示这些导弹不能在当前决策中被防御。<br>　　可以开个STL的优先队列或者堆记录之前被防御的导弹序号，按照st从小到大存，每次比较最小的st和开启时间et-Ta。并在过程中增减伤害值，并记录最小伤害。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rez(i,x,y) for(int i=x;i&gt;=y;i--)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> res(i,x,y) for(int i=x;i&lt;=y;i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2100000000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x)  memset(x,0,sizeof(x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 0x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 20004</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">readin</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;<span class="string">'9'</span>||ch&lt;<span class="string">'0'</span>);</div><div class="line">	res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;=<span class="string">'9'</span>&amp;&amp;ch&gt;=<span class="string">'0'</span>)</div><div class="line">	res=ch<span class="number">-48</span>+res*<span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n,m,cnt,ans;</div><div class="line"><span class="keyword">int</span> Ta,Tb,X,sum;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">    LL t,c,e,d;</div><div class="line">&#125;a[N],b[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmpf</span>&#123;</span></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span> <span class="params">()</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;lhs,<span class="keyword">const</span> <span class="keyword">int</span> &amp;rhs)</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> a[lhs].t&gt;a[rhs].t;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node lhs,node rhs)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> lhs.e&lt;rhs.e;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x,y,i,j;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;Ta,&amp;Tb)!=EOF)&#123;</div><div class="line">        cnt=<span class="number">0</span>,ans=MAX,sum=<span class="number">0</span>;</div><div class="line">        readin(X),readin(n),readin(m);</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">            readin(b[i].t),readin(b[i].c),readin(b[i].d);</div><div class="line">            b[i].e=b[i].t+b[i].c;</div><div class="line">            <span class="keyword">if</span>(b[i].e&gt;=X&amp;&amp;b[i].e&lt;=X+Tb)&#123;</div><div class="line">                sum+=b[i].d;</div><div class="line">                a[++cnt].t=b[i].e+b[i].c;</div><div class="line">                j=Tb+X-a[cnt].t;</div><div class="line">                j=j%(<span class="number">2</span>*b[i].c);</div><div class="line">                a[cnt].e=Tb+X-j;</div><div class="line">                a[cnt].d=b[i].d;</div><div class="line">                <span class="keyword">if</span>(j&gt;=b[i].c)a[cnt].e+=b[i].c+b[i].c;</div><div class="line">                <span class="keyword">if</span>(a[cnt].t+b[i].c&lt;X||a[cnt].t&gt;Tb+X)a[cnt].e=a[cnt].t;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">            readin(b[i].t),readin(b[i].c),readin(b[i].d);</div><div class="line">            b[i].e=b[i].t+b[i].c;</div><div class="line">            sum+=b[i].d;</div><div class="line">            a[++cnt].t=b[i].e;</div><div class="line">            j=Tb+X-a[cnt].t;</div><div class="line">            j=j%(<span class="number">2</span>*b[i].c);</div><div class="line">            a[cnt].e=Tb+X-j;</div><div class="line">            a[cnt].d=b[i].d;</div><div class="line">            <span class="keyword">if</span>(j&gt;=b[i].c)a[cnt].e+=b[i].c+b[i].c;</div><div class="line">            <span class="keyword">if</span>(a[cnt].t+b[i].c&lt;X||a[cnt].t&gt;Tb+X)a[cnt].e=a[cnt].t;</div><div class="line">        &#125;</div><div class="line">        sort(a+<span class="number">1</span>,a+cnt+<span class="number">1</span>,cmp);</div><div class="line">        priority_queue&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;,cmpf&gt;q;</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=cnt;i++)&#123;</div><div class="line">            q.push(i);y=a[i].e;</div><div class="line">            sum-=a[i].d;</div><div class="line">            x=q.top();</div><div class="line">            <span class="keyword">while</span>(y-a[x].t&gt;Ta&amp;&amp;!q.empty())&#123;</div><div class="line">                sum+=a[x].d;</div><div class="line">                q.pop();x=q.top();</div><div class="line">            &#125;</div><div class="line">            ans=min(ans,sum);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

  	</div>

	  <div class="article-tags tags">
		  
        <a class="tag-link" href="/tags/ACM/">ACM</a>
      
	  </div>
	</section>
</article>


<section id="comments">
	<div id="disqus_thread"></div>
</section>



      <script>setLoadingBarProgress(60);</script>
    </main>
    
    <footer id="footer" class="clearfix">
  
  
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" class="u-search-input" placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/artchen" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/otakism" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
        <a href="https://plus.google.com/+ArtChenOtakism/posts" class="social google"
          target="_blank" rel="external">
          <span class="icon icon-google"></span>
        </a>
      
        <a href="http://weibo.com/otakism/" class="social sina-weibo"
          target="_blank" rel="external">
          <span class="icon icon-sina-weibo"></span>
        </a>
      
    
  </div>
  
  <div>Theme <span class="codename">Typescript</span> designed by <a href="http://rakugaki.me/" target="_blank">Art Chen</a>.</div>
  <div>&copy; <a href="/">PIVIX</a></div>
  
</footer>


    <script>setLoadingBarProgress(80);</script>
    
  </div>

  
<script>
  var disqus_shortname = 'https://lemonoilP.github.io';
  
  var disqus_url = 'https://lemonoilP.github.io/2017/03/16/ACN-v-first/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>




<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>

<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "google";
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
  
</body>
</html>

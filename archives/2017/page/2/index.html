<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Archives: 2017 | PIVIX</title>
  <meta name="description" content="A minimal hexo theme." />
  <meta name="keywords" content="hexo,theme,typescript,otakism,otaku" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="PIVIX">
<meta property="og:url" content="https://lemonoilP.github.io/archives/2017/page/2/index.html">
<meta property="og:site_name" content="PIVIX">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PIVIX">
  
  
    <link rel="icon" href="/favicon.png">
  

	<script src="https://use.typekit.net/eyf3hir.js"></script>
  <script>try{Typekit.load({ async: false });}catch(e){}</script>
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
  

</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

  <script>setLoadingBarProgress(20)</script>
  
  <div id="site-wrapper">
    
    <header id="header">
	<div id="header-wrapper" class="clearfix">
		<a id="logo" href="/">
			<img src="/images/logo.png" />
			<span id="site-desc">
			  otaku keeps alive
      </span>
		</a>
		<button id="site-nav-switch">
	    <span class="icon icon-menu"></span>
	  </button>
	</div>
	<aside id="site-menu">
  	<nav>
  		
        <a href="/" class="nav-home nav">
          Home
        </a>
      
        <a href="/about" class="nav-about nav">
          About
        </a>
      
        <a href="/archives" class="nav-archives nav">
          Archives
        </a>
      
    </nav>
	</aside>
</header>
    <script>setLoadingBarProgress(40);</script>
    
    <main id="main" role="main">
      
	


	<section class="page-header archive">
    <h1>- <span>2017</span> -</h1>
  </section>




<section class="post-list">
	
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p>终于我的贪心过了，方法与题解不同，我每次记录历史最高值h，若当前x&lt;=h则可以，然后判定几个特殊条件，AC了。</p>
<p>高山算法是什么？自行百度，本人无厘头命名，貌似是时间空间最优的方法。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span>&#123;</span></div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> x,y;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> data &amp;rhs)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">return</span> x&lt;rhs.x||(x==rhs.x&amp;&amp;(y-x)&gt;(rhs.y-rhs.x));</div><div class="line">	&#125;</div><div class="line">&#125;a[N];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> &amp;res)</span></span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">char</span> ch;<span class="keyword">long</span> <span class="keyword">long</span> flag=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> t,n,w,h,flag,b;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"backpack.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"backpack.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	read(t);</div><div class="line">	<span class="keyword">while</span>(t--)&#123;</div><div class="line">		read(n),read(w);h=w;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)read(a[i].x),read(a[i].y);</div><div class="line">		sort(a+<span class="number">1</span>,a+<span class="number">1</span>+n),flag=<span class="number">1</span>;b=<span class="number">0x3f3f3f3f</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">			<span class="keyword">if</span>(h&lt;a[i].x)&#123;<span class="built_in">cout</span>&lt;&lt;<span class="string">"No"</span>&lt;&lt;<span class="built_in">endl</span>;flag=<span class="number">0</span>;<span class="keyword">break</span>;&#125;</div><div class="line">			w-=a[i].x;w+=a[i].y;</div><div class="line">			h=max(h,w);b=min(b,a[i].y);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(flag)&#123;</div><div class="line">			<span class="keyword">if</span>(w&lt;b)<span class="built_in">cout</span>&lt;&lt;<span class="string">"No"</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">			<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="string">"Yes"</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20170919164557692?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>


    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p>树链剖分+线段树裸题，<strong>注意边权维护的细节。</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x) memset((x),0,sizeof(x))</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200020</span>,inf=~<span class="number">0U</span>&gt;&gt;<span class="number">1</span>;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> cmd[<span class="number">10</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to,next,w;</div><div class="line">&#125;E[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> n,tot,head[N],deep[N],son[N],sz[N],fa[N],top[N],dfw[N],mx[N&lt;&lt;<span class="number">2</span>],dfn[N],w[N],cnt,b[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</div><div class="line">    E[tot].to=y,E[tot].next=head[x],E[tot].w=z,head[x]=tot++;</div><div class="line">    E[tot].to=x,E[tot].next=head[y],E[tot].w=z,head[y]=tot++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfsf</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</div><div class="line">	sz[u]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> v,i=head[u];~i;i=E[i].next)&#123;</div><div class="line">		<span class="keyword">if</span>(v=E[i].to,v!=fa[u])&#123;</div><div class="line">			b[i/<span class="number">2</span>+<span class="number">1</span>]=v,w[v]=E[i].w,deep[v]=deep[u]+<span class="number">1</span>,fa[v]=u,dfsf(v),sz[u]+=sz[v];</div><div class="line">			<span class="keyword">if</span>(sz[son[u]]&lt;sz[v])son[u]=v;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfss</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">	top[u]=f,dfn[u]=++cnt,dfw[cnt]=u;</div><div class="line">	<span class="keyword">if</span>(son[u])dfss(son[u],f);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> v,i=head[u];~i;i=E[i].next)</div><div class="line">		<span class="keyword">if</span>(v=E[i].to,v!=fa[u]&amp;&amp;v!=son[u])dfss(v,v);</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> R rt&lt;&lt;1|1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> L rt&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((rc+lc)&gt;&gt;1)</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(lc==rc)&#123;mx[rt]=w[dfw[lc]];<span class="keyword">return</span>;&#125;</div><div class="line">	build(L,lc,mid),build(R,mid+<span class="number">1</span>,rc);</div><div class="line">	mx[rt]=max(mx[L],mx[R]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(rc==r&amp;&amp;lc==l)<span class="keyword">return</span> mx[rt];</div><div class="line">	<span class="keyword">if</span>(r&lt;=mid)<span class="keyword">return</span> query(L,lc,mid,l,r);</div><div class="line">	<span class="keyword">if</span>(l&gt;mid)<span class="keyword">return</span> query(R,mid+<span class="number">1</span>,rc,l,r);</div><div class="line">	<span class="keyword">return</span> max(query(L,lc,mid,l,mid),query(R,mid+<span class="number">1</span>,rc,mid+<span class="number">1</span>,r));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> rt,<span class="keyword">int</span> val,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(lc==rc)&#123;mx[rt]=val;<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span>(x&lt;=mid)update(x,L,val,lc,mid);</div><div class="line">	<span class="keyword">else</span> update(x,R,val,mid+<span class="number">1</span>,rc);</div><div class="line">	mx[rt]=max(mx[L],mx[R]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ret=-inf;</div><div class="line">	<span class="keyword">while</span>(top[u]!=top[v])&#123;</div><div class="line">		<span class="keyword">if</span>(deep[top[u]]&gt;deep[top[v]])swap(u,v);</div><div class="line">        ret=max(ret,query(<span class="number">1</span>,<span class="number">1</span>,n,dfn[top[v]],dfn[v]));</div><div class="line">        v=fa[top[v]];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(deep[u]&gt;deep[v])swap(u,v);</div><div class="line">    <span class="keyword">if</span>(u!=v)ret=max(ret,query(<span class="number">1</span>,<span class="number">1</span>,n,dfn[u]+<span class="number">1</span>,dfn[v]));</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">	tot=cnt=<span class="number">0</span>;</div><div class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head)),clr(deep),clr(sz),clr(fa),clr(w),clr(mx),clr(son),clr(dfw),clr(dfn),clr(b);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;res)</span></span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">char</span> ch;<span class="keyword">int</span> flag=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> t;read(t);</div><div class="line">	<span class="keyword">while</span>(t--)&#123;</div><div class="line">		init();</div><div class="line">		read(n);</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">int</span> u,v,z,i=<span class="number">1</span>;i&lt;n;i++)read(u),read(v),read(z),addedge(u,v,z);</div><div class="line">		fa[<span class="number">1</span>]=<span class="number">-1</span>,dfsf(<span class="number">1</span>),dfss(<span class="number">1</span>,<span class="number">1</span>),build(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">	    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,cmd)&amp;&amp;cmd[<span class="number">0</span>]!=<span class="string">'D'</span>)&#123;</div><div class="line">	    	<span class="keyword">int</span> s,t;</div><div class="line">	        read(s),read(t);</div><div class="line">	        <span class="keyword">if</span>(cmd[<span class="number">0</span>]==<span class="string">'C'</span>)update(dfn[b[s]],<span class="number">1</span>,t,<span class="number">1</span>,n);</div><div class="line">	        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(s,t));</div><div class="line">	    &#125;</div><div class="line">	&#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p>直接上第一道题的模板，<br>关键是转化颜色到具体数值的思想很重要。<br>详细关于黑白分析的细节看代码。<br>吐槽一句：样例乱打都能过。。。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(x) memset((x),0,sizeof(x))</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">200020</span>,inf=<span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> cmd[<span class="number">10</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> to,next;</div><div class="line">&#125;E[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> n,m,tot,head[N],deep[N],son[N],sz[N],fa[N],top[N],flag[N],mx[N&lt;&lt;<span class="number">2</span>],dfn[N],cnt,dfw[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    E[tot].to=y,E[tot].next=head[x],head[x]=tot++;</div><div class="line">    E[tot].to=x,E[tot].next=head[y],head[y]=tot++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfsf</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</div><div class="line">	sz[u]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> v,i=head[u];~i;i=E[i].next)&#123;</div><div class="line">		<span class="keyword">if</span>(v=E[i].to,v!=fa[u])&#123;</div><div class="line">			deep[v]=deep[u]+<span class="number">1</span>,fa[v]=u,dfsf(v),sz[u]+=sz[v];</div><div class="line">			<span class="keyword">if</span>(sz[son[u]]&lt;sz[v])son[u]=v;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfss</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span></span>&#123;</div><div class="line">	top[u]=f,dfn[++cnt]=u,dfw[u]=cnt;</div><div class="line">	<span class="keyword">if</span>(son[u])dfss(son[u],f);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> v,i=head[u];~i;i=E[i].next)</div><div class="line">		<span class="keyword">if</span>(v=E[i].to,v!=fa[u]&amp;&amp;v!=son[u])dfss(v,v);</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> R rt&lt;&lt;1|1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> L rt&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((rc+lc)&gt;&gt;1)</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(lc==rc)&#123;mx[rt]=inf;<span class="keyword">return</span>;&#125;</div><div class="line">	build(L,lc,mid),build(R,mid+<span class="number">1</span>,rc);</div><div class="line">	mx[rt]=min(mx[L],mx[R]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(rc==r&amp;&amp;lc==l)<span class="keyword">return</span> mx[rt];</div><div class="line">	<span class="keyword">if</span>(r&lt;=mid)<span class="keyword">return</span> query(L,lc,mid,l,r);</div><div class="line">	<span class="keyword">if</span>(mid&lt;l)<span class="keyword">return</span> query(R,mid+<span class="number">1</span>,rc,l,r);</div><div class="line">	<span class="keyword">return</span> min(query(L,lc,mid,l,mid),query(R,mid+<span class="number">1</span>,rc,mid+<span class="number">1</span>,r));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> rt,<span class="keyword">int</span> lc,<span class="keyword">int</span> rc)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(lc==rc)&#123;<span class="keyword">if</span>(mx[rt]==inf)mx[rt]=x;<span class="keyword">else</span> mx[rt]=inf;<span class="keyword">return</span>;&#125;</div><div class="line">	<span class="keyword">if</span>(x&lt;=mid)update(x,L,lc,mid);</div><div class="line">	<span class="keyword">else</span> update(x,R,mid+<span class="number">1</span>,rc);</div><div class="line">	mx[rt]=min(mx[L],mx[R]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> ret=inf;</div><div class="line">	<span class="keyword">while</span>(u)ret=min(ret,query(<span class="number">1</span>,<span class="number">1</span>,n,dfw[top[u]],dfw[u])),u=fa[top[u]];</div><div class="line">	<span class="keyword">if</span>(ret==inf)ret=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">else</span> ret=dfn[ret];</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;res)</span></span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">char</span> ch;<span class="keyword">int</span> flag=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">    <span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	read(n),read(m);<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> u,v,z,i=<span class="number">1</span>;i&lt;n;i++)read(u),read(v),addedge(u,v);</div><div class="line">	fa[<span class="number">1</span>]=<span class="number">0</span>,dfsf(<span class="number">1</span>),dfss(<span class="number">1</span>,<span class="number">1</span>),build(<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="keyword">int</span> s,t;</div><div class="line">        read(s),read(t);</div><div class="line">        <span class="keyword">if</span>(s)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(t));</div><div class="line">        <span class="keyword">else</span> update(dfw[t],<span class="number">1</span>,<span class="number">1</span>,n);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <h1 id="BZOJ3224-传送门"><a href="#BZOJ3224-传送门" class="headerlink" title="BZOJ3224 传送门"></a><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3224" target="_blank" rel="external">BZOJ3224 传送门</a></h1><h2 id="模板而已。。"><a href="#模板而已。。" class="headerlink" title="模板而已。。"></a>模板而已。。</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> update(cur)<span class="meta-keyword">if</span>(cur-&gt;left-&gt;size)cur-&gt;size=cur-&gt;left-&gt;size+cur-&gt;right-&gt;size,cur-&gt;value=cur-&gt;right-&gt;value</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> new_Node(s,v,a,b)(&amp;(*st[cnt++]=Node(s,v,a,b)))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> merge(a,b)new_Node(a-&gt;size+b-&gt;size,b-&gt;value,a,b)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ratio 4</span></div><div class="line"><span class="keyword">int</span> n,cnt,s,a;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> size,value;</div><div class="line">    Node *left,* right;</div><div class="line">    Node(<span class="keyword">int</span> s,<span class="keyword">int</span> v,Node *a,Node *b):size(s),value(v),left(a),right(b)&#123;&#125;</div><div class="line">    Node()&#123;&#125;</div><div class="line">&#125;*root,*null,*father,t[<span class="number">200005</span>],*st[<span class="number">200005</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a&lt;b?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a&gt;b?a:b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">maintain</span><span class="params">(Node *cur)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(cur-&gt;left-&gt;size&gt;cur-&gt;right-&gt;size *ratio)</div><div class="line">		cur-&gt;right=merge(cur-&gt;left-&gt;right,cur-&gt;right),</div><div class="line">		st[--cnt]=cur-&gt;left,cur-&gt;left=cur-&gt;left-&gt;left;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cur-&gt;right-&gt;size&gt;cur-&gt;left-&gt;size *ratio)</div><div class="line">		cur-&gt;left=merge(cur-&gt;left,cur-&gt;right-&gt;left),</div><div class="line">		st[--cnt]=cur-&gt;right,cur-&gt;right=cur-&gt;right-&gt;right;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x,Node *cur)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(cur-&gt;size==<span class="number">1</span>)<span class="keyword">return</span> cur-&gt;value;</div><div class="line">    <span class="keyword">return</span> x&gt;cur-&gt;left-&gt;size?find(x - cur-&gt;left-&gt;size,cur-&gt;right):find(x,cur-&gt;left);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">rank</span><span class="params">(<span class="keyword">int</span> x,Node *cur)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(cur-&gt;size==<span class="number">1</span>)<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> x&gt;cur-&gt;left-&gt;value ? rank(x,cur-&gt;right)+ cur-&gt;left-&gt;size:rank(x,cur-&gt;left);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x,Node *cur)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(cur-&gt;size==<span class="number">1</span>)</div><div class="line">		cur-&gt;left=new_Node(<span class="number">1</span>,min(cur-&gt;value,x),null,null),</div><div class="line">		cur-&gt;right=new_Node(<span class="number">1</span>,max(cur-&gt;value,x),null,null);</div><div class="line">    <span class="keyword">else</span> insert(x,x&gt;cur-&gt;left-&gt;value ? cur-&gt;right:cur-&gt;left);</div><div class="line">    update(cur),maintain(cur);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">erase</span><span class="params">(<span class="keyword">int</span> x,Node *cur)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(cur-&gt;size==<span class="number">1</span>)*father=cur==father-&gt;left?*father-&gt;right:*father-&gt;left;</div><div class="line">    <span class="keyword">else</span> father=cur,erase(x,x&gt;cur-&gt;left-&gt;value?cur-&gt;right:cur-&gt;left);</div><div class="line">    update(cur),maintain(cur);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    n=read();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">200005</span>;i++)st[i]=&amp;t[i];</div><div class="line">    null=<span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</div><div class="line">    root=<span class="keyword">new</span> Node(<span class="number">1</span>,<span class="number">2147483647</span>,null,null);</div><div class="line">    <span class="keyword">while</span>(n--)&#123;</div><div class="line">        s=read(),a=read();</div><div class="line">        <span class="keyword">if</span>(s==<span class="number">1</span>)insert(a,root);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s==<span class="number">2</span>)erase(a,root);</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s==<span class="number">3</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,rank(a,root));</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s==<span class="number">4</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,find(a,root));</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(s==<span class="number">5</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,find(rank(a,root)<span class="number">-1</span>,root));</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,find(rank(a+<span class="number">1</span>,root),root));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p></p><h2>4170: 极光</h2><span class="green">Time Limit: </span>30 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>512 MB<br><span class="green">Submit: </span>198&nbsp;&nbsp;<span class="green">Solved: </span>100<br>[<a href="submitpage.php?id=4170">Submit</a>][<a href="problemstatus.php?id=4170">Status</a>][<a href="bbs.php?id=4170">Discuss</a>]<h2>Description</h2><div class="content"><div>&quot;若是万一琪露诺（俗称rhl）进行攻击，什么都好，冷静地回答她的问题来吸引她。对方表现出兴趣的话，那就慢</div><p></p>
<p><div>慢地反问。在她考虑答案的时候，趁机逃吧。就算是很简单的问题，她一定也答不上来。&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div></p>
<p><div>&nbsp;–《上古之魔书》</div></p>
<p><div></div></p>
<p><div>天空中出现了许多的北极光，这些北极光组成了一个长度为n的正整数数列a[i],远古之魔书上记载到：2个位置的g</div></p>
<p><div>raze值为两者位置差与数值差的和：</div></p>
<p><div>graze(x,y)=|x-y|+|a[x]-a[y]|。</div></p>
<p><div>要想破解天罚，就必须支持2种操作（k都是正整数）：</div></p>
<p><div>Modify x k：将第x个数的值修改为k。</div></p>
<p><div>Query x k：询问有几个i满足graze(x,i)&lt;=k。</div></p>
<p><div>由于从前的天罚被圣王lmc破解了，所以rhl改进了她的法术，询问不仅要考虑当前数列，还要考虑任意历史版本，</div></p>
<p><div>即统计任意位置上出现过的任意数值与当前的a[x]的graze值&lt;=k的对数。（某位置多次修改为同样的数值，按多次</div></p>
<p><div>统计）</div></p></div><h2>Input</h2><div class="content"><div>第1行两个整数n,q。分别表示数列长度和操作数。</div><p></p>
<p><div>第2行n个正整数，代表初始数列。</div></p>
<p><div>第3~q+2行每行一个操作。</div></p>
<p><div>N&lt;=40000, <span style="color: rgb(255, 0, 0);">修改操作数&lt;=60000</span>, 询问操作数&lt;=10000, Max{a[i]}(含修改)&lt;=80000</div></p></div><h2>Output</h2><div class="content"><p>对于每次询问操作，输出一个非负整数表示答案</p></div><h2>Sample Input</h2><br>3 5<br><br>2 4 3<br><br>Query 2 2<br><br>Modify 1 3<br><br>Query 2 2<br><br>Modify 1 2<br><br>Query 1 1<br><br><h2>Sample Output</h2><br>3<br><br>3<h2>HINT</h2><h2>Source</h2><p></p>
<p>可以把坐标系旋转一下，点(x,y)变成(x+y,-x+y)，这样查询曼哈顿距离&lt;=k的就变成查边长为2k的正方形里的点的个数，然后用二维线段树乱搞就行了。。。。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200005</span> ,M = <span class="number">20000007</span>;</div><div class="line"><span class="keyword">int</span> sz[M],a[N],son[M][<span class="number">2</span>],tree[N&lt;&lt;<span class="number">2</span>],n,m,lim=<span class="number">200000</span>,limr=<span class="number">100000</span>,liml=<span class="number">-100000</span>,tot;</div><div class="line"><span class="keyword">char</span> cmd[<span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">changef</span><span class="params">(<span class="keyword">int</span> &amp;rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(!rt)rt=++tot;</div><div class="line">	sz[rt]++;</div><div class="line">	<span class="keyword">if</span>(l==r)<span class="keyword">return</span> ;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(p&gt;mid)changef(son[rt][<span class="number">1</span>],mid+<span class="number">1</span>,r,p);</div><div class="line">	<span class="keyword">else</span> changef(son[rt][<span class="number">0</span>],l,mid,p);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">changes</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> p,<span class="keyword">int</span> q)</span></span>&#123;</div><div class="line">	changef(tree[rt],liml,limr,q);</div><div class="line">	<span class="keyword">if</span>(l==r)<span class="keyword">return</span> ;</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(p&gt;mid)changes(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,p,q);</div><div class="line">	<span class="keyword">else</span> changes(rt&lt;&lt;<span class="number">1</span>,l,mid,p,q);	</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">queryf</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> L,<span class="keyword">int</span> R)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(L&lt;liml)L=liml;</div><div class="line">	<span class="keyword">if</span>(R&gt;limr)R=limr;</div><div class="line">	<span class="keyword">if</span>(!rt)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(l==L&amp;&amp;r==R)<span class="keyword">return</span> sz[rt];</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(R&lt;=mid)<span class="keyword">return</span> queryf(son[rt][<span class="number">0</span>],l,mid,L,R);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(L&gt;mid)<span class="keyword">return</span> queryf(son[rt][<span class="number">1</span>],mid+<span class="number">1</span>,r,L,R);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> queryf(son[rt][<span class="number">0</span>],l,mid,L,mid)+queryf(son[rt][<span class="number">1</span>],mid+<span class="number">1</span>,r,mid+<span class="number">1</span>,R);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">querys</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> li,<span class="keyword">int</span> ri,<span class="keyword">int</span> L,<span class="keyword">int</span> R)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(li&lt;<span class="number">1</span>)li=<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(ri&gt;lim)ri=lim;</div><div class="line">	<span class="keyword">if</span>(l==li&amp;&amp;ri==r)<span class="keyword">return</span> queryf(tree[rt],liml,limr,L,R);</div><div class="line">	<span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(ri&lt;=mid)<span class="keyword">return</span> querys(rt&lt;&lt;<span class="number">1</span>,l,mid,li,ri,L,R);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(li&gt;mid)<span class="keyword">return</span> querys(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,li,ri,L,R);</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> querys(rt&lt;&lt;<span class="number">1</span>,l,mid,li,mid,L,R)+querys(rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,r,mid+<span class="number">1</span>,ri,L,R);</div><div class="line">&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;T flag=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	read(n),read(m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)read(a[i]),changes(<span class="number">1</span>,<span class="number">1</span>,lim,i+a[i],-i+a[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> x,y,i=<span class="number">1</span>;i&lt;=m;i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,cmd);</div><div class="line">		read(x),read(y);</div><div class="line">		<span class="keyword">if</span>(cmd[<span class="number">0</span>]==<span class="string">'Q'</span>)<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,querys(<span class="number">1</span>,<span class="number">1</span>,lim,x+a[x]-y,x+a[x]+y,-x+a[x]-y,-x+a[x]+y));</div><div class="line">		<span class="keyword">else</span> a[x]=y,changes(<span class="number">1</span>,<span class="number">1</span>,lim,x+y,-x+y);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20170922164831061?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>


    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <h2 id="清北学堂第一天——DP"><a href="#清北学堂第一天——DP" class="headerlink" title="#清北学堂第一天——DP"></a>#清北学堂第一天——DP</h2><h2 id="主讲人——胡泽聪"><a href="#主讲人——胡泽聪" class="headerlink" title="###主讲人——胡泽聪"></a>###主讲人——胡泽聪</h2><p>在我写这篇博客的时候，我已经从北京回到成都了，回顾这七天的学习，除了超出我现有知识体系的knowledge以外，更多的是了解了信息学竞赛究竟意味着什么，对我自己又有何意义。<br>伴随着感叹，我开始了整理。</p>
<p>##DP（个人理解）<br>不同于<strong>数据结构</strong>和<strong>网络流</strong>（到现在还停留在模板题），dp是最让我震撼与头痛的，巧妙的思想，灵活的变形，与其他知识点纷繁复杂的搭配（特别是<strong>数论</strong>），吸引着一代代OIer。</p>
<p>##DP的序章</p>
<p>###CodeChef June13 LEMOUSE</p>
<p><a href="https://www.codechef.com/JUNE13/problems/LEMOUSE" target="_blank" rel="external">https://www.codechef.com/JUNE13/problems/LEMOUSE</a></p>
<p>题目就略了，这道题目是dp，还是很明显的，但是如何做？用状压dp保存九宫格？曼哈顿距离是关键，回顾题目一只老鼠只会吓到大象一次，所以说，我们只需要记录走到这一步之前的f[i,j]来决定是否会重复记录已发现的老鼠，再仔细一想，对于dp[i,j]若在九宫格的四角上，那么我们只需要记录上一步是否被吓到就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line">#include &lt;stack&gt;</div><div class="line">#include &lt;cmath&gt;</div><div class="line">#include &lt;algorithm&gt;</div><div class="line">#include &lt;utility&gt;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">#include &lt;cstdio&gt;</div><div class="line">#include &lt;cmath&gt;</div><div class="line">#include &lt;cstdlib&gt;</div><div class="line">#include &lt;cstring&gt;</div><div class="line">#define mod  1000000007</div><div class="line">#define PHI 1000000006</div><div class="line">#define ull unsigned long long</div><div class="line">#define ill long long int</div><div class="line">#define pii pair&lt;int,int&gt;</div><div class="line">#define pb(x) push_back(x)</div><div class="line">#define F(i,a,n) for(i=(a);i&lt;(n);++i)</div><div class="line">#define FD(i,a,n) for(i=(a);i&gt;=(n);--i)</div><div class="line">#define S(x) scanf(&quot;%d&quot;,&amp;x)</div><div class="line">#define S1(x) scanf(&quot;%llu&quot;,&amp;x)</div><div class="line">using namespace std;</div><div class="line">typedef unsigned long long int uint64;</div><div class="line"> </div><div class="line">int dp[101][101][3][3];</div><div class="line">char s[101][101];</div><div class="line">int n,m;</div><div class="line">int aa[] = &#123;0, 1&#125;;</div><div class="line">int bb[] = &#123;1, 0&#125;;</div><div class="line"> </div><div class="line">int f (int sx, int sy, int down, int right)</div><div class="line">&#123;</div><div class="line"> </div><div class="line">    down = min (down, 2);</div><div class="line">    right = min (right, 2);</div><div class="line">    int &amp;result = dp[sx][sy][down][right];</div><div class="line">    if (result != -1) &#123;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    result = 0;</div><div class="line"> </div><div class="line">    if (down == 2) &#123;</div><div class="line">        if (sy-1 &gt;= 0) &#123;</div><div class="line">            if (s[sx][sy-1] == &apos;1&apos;) &#123;</div><div class="line">                result++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    if (right == 2) &#123;</div><div class="line">        if (sx-1 &gt;= 0) &#123;</div><div class="line">            if (s[sx-1][sy] == &apos;1&apos;) &#123;</div><div class="line">                result++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    if (sx == n-1 &amp;&amp; sy == m-1) &#123;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    int i,xx=1000000;</div><div class="line"> </div><div class="line">    F (i, 0, 2) &#123;</div><div class="line">        int px,py;</div><div class="line">        px = sx + aa[i];    py = sy + bb[i];</div><div class="line">        if (px == n || py == m) &#123;</div><div class="line">            continue;</div><div class="line">        &#125;</div><div class="line">        if (s[px][py] == &apos;1&apos;) &#123;</div><div class="line">            result++;</div><div class="line">        &#125;</div><div class="line">        int r,d;</div><div class="line">        r = right;   d = down;</div><div class="line">        if (i == 0) &#123;</div><div class="line">            r++;</div><div class="line">            d = 0;</div><div class="line">        &#125;</div><div class="line">        if (i == 1) &#123;</div><div class="line">            d++;</div><div class="line">            r = 0;</div><div class="line">        &#125;</div><div class="line">        xx = min (xx, f (px, py, d, r));</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    result = result + xx;</div><div class="line">    return result;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"> </div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    int t;</div><div class="line">    S (t);</div><div class="line">    while (t--) &#123;</div><div class="line">        S (n);  S (m);</div><div class="line"> </div><div class="line">        int i,j;</div><div class="line">        memset (dp, -1, sizeof(dp));</div><div class="line"> </div><div class="line">        F (i, 0, n) &#123;</div><div class="line">            scanf (&quot;%s&quot;, &amp;s[i]);</div><div class="line">        &#125;</div><div class="line"> </div><div class="line"> </div><div class="line">        int x = f (0, 0, 0, 0);</div><div class="line">        if (s[0][0] == &apos;1&apos;) &#123;</div><div class="line">            x++;</div><div class="line">        &#125;</div><div class="line">        printf (&quot;%d\n&quot;, x);</div><div class="line"> </div><div class="line">    &#125;</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###TopCoder Open 2014 Round 1B L3<br><strong>EagleInZoo</strong></p>
<p><a href="https://community.topcoder.com/stat?c=problem_statement&amp;pm=13117" target="_blank" rel="external">https://community.topcoder.com/stat?c=problem_statement&amp;pm=13117</a></p>
<p>这道题有数学期望………………但是作为一道树上dp，我觉得很适合练手。首先这道题很明显有子问题，用dp[i,j]表示j只鹰从i节点出发留在树上的概率，所以dp[i,1]=1,当j&gt;1时，若ci=0，则dp[i,j]=0。<br>然后就是dp方程了：<br>dp[x,k]=$ \sum_{y\in_child \leaf(i\right)}\frac{1}{c<em>x} \sum</em>{i=0}^{k-2} \left( \frac{k-2}{i} \right) \left( \frac{1}{c_x} \right)^i \left( 1-\frac{1}{c_x} \right)^{k-2-i} $p[y,i+1]<br>(还没有下载latex，先将就着看，应该看得懂，描述已经够通俗了……)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utility&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;deque&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CHECKTIME() printf(<span class="meta-string">"%.2lf\n"</span>, (double)clock() / CLOCKS_PER_SEC)</span></div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> llong;</div><div class="line"><span class="keyword">typedef</span> pair&lt;llong, llong&gt; pll;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mkp make_pair</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">51</span>, MAX_K = <span class="number">101</span>;</div><div class="line"><span class="keyword">double</span> dp[MAX_N][MAX_K];</div><div class="line"><span class="keyword">double</span> C[MAX_K][MAX_K];		<span class="comment">// 二项系数，注意：用 long long 会溢出</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EagleInZoo</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">	<span class="built_in">vector</span> &lt; <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; childs;</div><div class="line">	<span class="function"><span class="keyword">double</span> <span class="title">rec</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> t)</span></span></div><div class="line"><span class="function">	</span>&#123;</div><div class="line">		<span class="keyword">if</span> (<span class="number">1</span> == t) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="number">1.0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">double</span> &amp; res = dp[v][t];</div><div class="line">		<span class="keyword">if</span> (res &gt; <span class="number">-0.5</span>) &#123;</div><div class="line">			<span class="keyword">return</span> res;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (childs[v].size() == <span class="number">0</span> &amp;&amp; t &gt; <span class="number">1</span>) &#123;	<span class="comment">// 该节点无 child 且t &gt; 1，最后一只一定无法停留</span></div><div class="line">			res = <span class="number">0</span>;</div><div class="line">			<span class="keyword">return</span> res;</div><div class="line">		&#125;</div><div class="line">		res = <span class="number">0</span>;</div><div class="line"></div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; childs[v].size(); i++) &#123;</div><div class="line">			<span class="keyword">int</span> x = childs[v][i];</div><div class="line">			<span class="keyword">int</span> c = childs[v].size();</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= t - <span class="number">2</span>; j++) &#123;</div><div class="line">				res += (<span class="number">1.0</span> / c) * C[t<span class="number">-2</span>][j] * <span class="built_in">pow</span>(<span class="number">1.0</span> / c, j) * <span class="built_in">pow</span>( <span class="number">1.0</span> * (c<span class="number">-1</span>) / c, t<span class="number">-2</span>-j) * rec(x, j + <span class="number">1</span>);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">return</span> res;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; parent, <span class="keyword">int</span> K)</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAX_N; i++) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; MAX_K; j++) &#123;</div><div class="line">				dp[i][j] = <span class="number">-1.0</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		childs.resize(parent.size() + <span class="number">1</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; parent.size(); i++) &#123;</div><div class="line">			childs[ parent[i] ].push_back(i + <span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// calculate C[]</span></div><div class="line">		C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K - <span class="number">1</span>; i++) &#123;</div><div class="line">			C[i][<span class="number">0</span>] = C[i][i] = <span class="number">1</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++) &#123;</div><div class="line">				C[i][j] = C[i - <span class="number">1</span>][j] + C[i - <span class="number">1</span>][j - <span class="number">1</span>];</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> rec(<span class="number">0</span>, K);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//**复杂度O（nk^2）**</span></div></pre></td></tr></table></figure>
<p>补充试题： </p>
<p><a href="http://codeforces.com/contest/341/problem/C" target="_blank" rel="external">http://codeforces.com/contest/341/problem/C</a></p>
<p><a href="https://www.codechef.com/APRIL14/problems/ANUCBC" target="_blank" rel="external">https://www.codechef.com/APRIL14/problems/ANUCBC</a></p>
<p>##进击的DP</p>
<p>###CodeChef FEB14 LEMOVIE<br><strong>little elephant and movies</strong></p>
<p><a href="https://www.codechef.com/FEB14/problems/LEMOVIE" target="_blank" rel="external">https://www.codechef.com/FEB14/problems/LEMOVIE</a></p>
<p>严格大于，就是最长上升子序列，先考虑互不相同，然后在想如何去重，用dp[i,j]表示插入前i大的数，激动值为j的方案数。<br>每组数的贡献值最多为1，且满足了后无效性，之后的数不会改变之前的dp。复杂度也就<strong>O(nk)</strong>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;climits&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"> </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i,a,b) 	for(int i= (int )a ; i &lt; (int )b ; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,n) 	FOR(i,0,n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF		INT_MAX</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ALL(x) 		x.begin(),x.end()</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LET(x,a)	__typeof(a) x(a)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> IFOR(i,a,b) 	for(LET(i,a);i!=(b);++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> EACH(it,v) 	IFOR(it,v.begin(),v.end())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb 		push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) 		int(x.size())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp 		make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fill(x,v)	memset(x,v,sizeof(x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a,b)	((a)&gt;(b)?(a):(b))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a,b)	((a)&lt;(b)?(a):(b))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span>	si(n)		scanf(<span class="meta-string">"%d"</span>,&amp;n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pi(n)		printf(<span class="meta-string">"%d "</span>,n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pil(n)		printf(<span class="meta-string">"%d\n"</span>,n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sd(n)		scanf(<span class="meta-string">"%lf"</span>,&amp;n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sl(n)		scanf(<span class="meta-string">"%lld"</span>,&amp;n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pl(n)		printf(<span class="meta-string">"%lld\n"</span>,n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ss(n)		scanf(<span class="meta-string">"%s"</span>,n)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> scan(v,n)	vector<span class="meta-string">&lt;int&gt; v;rep(i,n)&#123; int j;si(j);v.pb(j);&#125;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod (int)(1e9 + 7)</span></div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PI;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VI;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;VI&gt; VVI;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line">LL dp[<span class="number">202</span>][<span class="number">202</span>][<span class="number">202</span>],dp2[<span class="number">202</span>][<span class="number">202</span>][<span class="number">202</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">	<span class="keyword">int</span> i,j,n,t,k;</div><div class="line">	<span class="keyword">for</span>(si(t);t--;)</div><div class="line">	&#123;</div><div class="line">		VI cnt,cum;</div><div class="line">		si(n);</div><div class="line">		si(k);</div><div class="line">		cnt.resize(<span class="number">201</span>);</div><div class="line">		rep(i,n)</div><div class="line">		&#123;</div><div class="line">			si(j);</div><div class="line">			cnt[j]++;</div><div class="line">		&#125;</div><div class="line">		fill(dp,<span class="number">0</span>);</div><div class="line">		fill(dp2,<span class="number">0</span>);</div><div class="line">		dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = dp2[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">		cum.pb(<span class="number">0</span>);</div><div class="line">		FOR(i,<span class="number">1</span>,<span class="number">201</span>)</div><div class="line">			cum.pb(cum.back() + cnt[i]);</div><div class="line">		LL ans = <span class="number">0</span>;</div><div class="line">		rep(i,<span class="number">201</span>)</div><div class="line">		&#123;</div><div class="line">			rep(j,n+<span class="number">1</span>)</div><div class="line">			&#123;</div><div class="line">				rep(sum,cum[i]+<span class="number">1</span>)</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">if</span>(sum)</div><div class="line">						dp[i][j][sum] = dp[i][j][sum<span class="number">-1</span>]*(cum[i]-sum+<span class="number">1</span>);</div><div class="line">					<span class="keyword">if</span>(j <span class="keyword">and</span> sum)</div><div class="line">					&#123;</div><div class="line">						dp[i][j][sum] += dp2[i<span class="number">-1</span>][j<span class="number">-1</span>][sum<span class="number">-1</span>]*cnt[i];</div><div class="line">						dp[i][j][sum] %= mod;</div><div class="line">					&#125;</div><div class="line">					dp2[i][j][sum] = (dp[i][j][sum] + dp2[i<span class="number">-1</span>][j][sum])%mod;</div><div class="line">					<span class="keyword">if</span>(j&lt;=k <span class="keyword">and</span> sum==n)</div><div class="line">						ans = (ans + dp[i][j][sum])%mod;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; ans%mod &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>###Codeforces Round #211(Div. 1):problem C<br><strong>Circling Round Treasures</strong><br>一开始看到这道题的时候想到的是强连通分量，用trajan来缩点，但毕竟是dp题，缩点这种贪心的方式果然是有漏洞的（漏洞是什么请读者自己思考），然后就学习了<strong>射线法（本该是计算几何的内容）</strong>（话说知识点交叉是很频繁的啊，数据结构中讲了点分治…………），然后就可以判断点与多边形的位置关系，之后就dp大法好。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>

    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p></p><h2>2725: [Violet 6]故乡的梦</h2><span class="green">Time Limit: </span>20 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>715&nbsp;&nbsp;<span class="green">Solved: </span>222<br>[<a href="submitpage.php?id=2725">Submit</a>][<a href="problemstatus.php?id=2725">Status</a>][<a href="bbs.php?id=2725">Discuss</a>]<h2>Description</h2><div class="content"><p><img height="405" alt="" width="663" src="http://www.lydsy.com/JudgeOnline/upload/201204/T3des(5).gif"></p></div><h2>Input</h2><div class="content"><p><img height="278" alt="" width="661" src="http://www.lydsy.com/JudgeOnline/upload/201204/T3input(5).gif"></p></div><h2>Output</h2><div class="content"><p><img height="119" alt="" width="398" src="http://www.lydsy.com/JudgeOnline/upload/201204/T3output(5).gif"></p></div><h2>Sample Input</h2><br>6 7 <br><br>1 2 1 <br><br>2 3 1 <br><br>3 4 2 <br><br>4 5 1 <br><br>5 6 1 <br><br>1 3 3 <br><br>4 6 3 <br><br>1 6 <br><br>4 <br><br>1 2 <br><br>1 3 <br><br>4 3 <br><br>6 5 <h2>Sample Output</h2><br>            <div class="content"><span class="sampledata">7<br><br>6<br><br>Infinity<br><br>7</span></div><h2>HINT</h2><br>            <div class="content"><p></p><p><img height="188" alt="" width="661" src="http://www.lydsy.com/JudgeOnline/upload/201204/T3hint(5).gif"></p><p></p></div><h2>Source</h2><br>            <div class="content"><p><a href="problemset.php?search=interviewstreet--Going office ">interviewstreet–Going office </a></p></div><p></p>
<p>别的不说光是这代码量我就服了，追求严谨，我写了网络流与Tarjan，各种花式作死。dinic只搞两次加了，当前弧没什么效果。。。还是用了优先队列，毕竟空间使用都是线性的，总的时间复杂度也很优，只有\(O((n+m)+nlogn)\),算法的时间瓶颈上线是dijsktra带来的，换成SPFA是否有更好的表现？<br>直接无耻地引用题解 by <a href="http://www.cnblogs.com/DaD3zZ-Beyonder/p/5787906.html" target="_blank" rel="external">DaD3zZ大佬%%%%</a></p>
<blockquote>
<p>首先我们考虑，如果ST不连通，那显然全部输出Infinity</p>
<p>我们先做两遍\(Dijsktra\)，求出S出发到所有点的单源最短路\(ds[]\)，以及T出发到所有点的单源最短路\(dt[]\)</p>
<p>那么我们发现，如果删除的边不存在最短路径上，那么显然答案全都是\(ds[T]\)</p>
<p>考虑利用\(ds[]\)和\(dt[]\)的信息，构建一种新的图  最短路径图Gs 即满足\(ds[u]+val(u–&gt;v)=ds[v]\)的边所构成的图，同理做出Gt</p>
<p>那么我们需要找到\(Gs Gt\)中的割边，因为只有割这种边，才会使得最短路径发生变化</p>
<p>那么问题在于如何求，\(Tarjan\)的方法，正确性位置，不妨考虑最小割，<br>所以我们假定每条边容量为1，我们在\(Gs\)上进行增广，如果\(MinCut&gt;=2\)，那么任意删一条边对结果不造成影响，因为只需要知道是否&gt;=2所以增广两次即可<br>那么当最小割为1时，我们需要求割边，这时候利用\(Tarjan\)，<br>在残余网络上跑tarjan求出所有SCC，记\(belong[u]\)为点u所在SCC的编号。显然有\(belong[s]!=belong[t]\)（否则s到t有通路，能继续增广）。<br>①对于任意一条满流边\((u,v)\)，\((u,v)\)能够出现在某个最小割集中，当且仅当\(belong[u]!=belong[v]\)；<br>②对于任意一条满流边\((u,v\)，\((u,v)\)必定出现在最小割集中，当且仅当\(belong[u]==belong[s]\)且\(belong[v]==belong[t]\)。  应用:BZOJ1797</p>
<p>求出这些割边后，我们知道，删除非割边并不影响答案，所以输出$ds[T]$，只有割边会对答案有影响</p>
<p>同样的，Gs中的割边反向就是Gt中的割边<br>那么我们求出这些割边，\(cut(1~K) \)，显然我们可以离线的处理出每条割边的答案，然后\( O（1）\)询问<br>我们对最短路径图\(Gs\)再进行改动，其中的割边我们设\(val=1\)，非割边\(val=0\)，然后我们可以求出\(Gs\)，\(Gt\)中\(S/T\)到每个点的最短路\(（0/1）\)构成<br>这个实现起来可以利用 BFS+双端队列<br>然后我们可以离线的处理出每个\(cut\)的答案，这个过程可以利用\(multiset/heap/线段树\) 来实现<br>堆的方法：<br>维护一个小根堆，关键字是\(ds[u]+val(u–&gt;v)+dt[v]\)，具体的方法就是 当前计算的是now，先将之前的状态\(（Dt[v]&gt;=Sum-now)\)弹出，然后把当前的所有出边加入到堆中，然后用堆顶答案去更新接下来的值<br>线段树的方法：<br>区间覆盖取最小的经典模型，先修改，再DFS一遍整棵线段树即可<br>multiset的方法：<br>扫描cut的时候，记录所有可行的答案，然后取最小来更新即可<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> RG</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;T flag=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="comment">//------------------init---------------------</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> INF = (<span class="number">1L</span>L&lt;&lt;<span class="number">50</span>);</div><div class="line"><span class="keyword">int</span> S,T,n,m,k,head[N],cnt=<span class="number">1</span>;</div><div class="line"><span class="comment">//----------------dijsktra-------------------</span></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> ds[N],dt[N];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> from,to,w,nxt;</div><div class="line">&#125;E[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</div><div class="line">	E[++cnt].nxt=head[x],head[x]=cnt,E[cnt].to=y,E[cnt].w=z,E[cnt].from=x;</div><div class="line">	E[++cnt].nxt=head[y],head[y]=cnt,E[cnt].to=x,E[cnt].w=z,E[cnt].from=y;</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pairs pair<span class="meta-string">&lt;long long ,int&gt;</span></span></div><div class="line">priority_queue&lt;pairs,<span class="built_in">vector</span>&lt;pairs&gt;,greater&lt;pairs&gt; &gt; Q;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijsktra</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t,<span class="keyword">long</span> <span class="keyword">long</span> dis[N])</span></span>&#123;</div><div class="line">	fill(dis,dis+N,INF);</div><div class="line">	Q.push(make_pair(<span class="number">0</span>,s)),dis[s]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(!Q.empty())&#123;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> dist=Q.top().first;</div><div class="line">		<span class="keyword">int</span> u=Q.top().second;Q.pop();</div><div class="line">		<span class="keyword">if</span>(dist&gt;dis[u])<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> v,i=head[u];i;i=E[i].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(v=E[i].to,dis[u]+E[i].w&lt;dis[v])&#123;</div><div class="line">				dis[v]=dis[u]+E[i].w;</div><div class="line">				Q.push(make_pair(dis[v],v));</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//------------------dinic--------------------</span></div><div class="line"><span class="keyword">int</span> last[N],first[N],num=<span class="number">1</span>,tot=<span class="number">1</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> nxt,to,from,w;</div><div class="line">&#125;L[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Road</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> nxt,to,from,cap,w;</div><div class="line">&#125;G[N&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addroad</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> w)</span></span>&#123;</div><div class="line">	G[++tot].nxt=last[x],last[x]=tot,G[tot].to=y,G[tot].from=x,G[tot].cap=w;</div><div class="line">	G[++tot].nxt=last[y],last[y]=tot,G[tot].to=x,G[tot].from=y,G[tot].cap=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addlist</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> w)</span></span>&#123;</div><div class="line">	L[++num].nxt=first[x],first[x]=num,L[num].to=y,L[num].from=x,L[num].w=w;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">createGraph</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> j=head[i];j;j=E[j].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(ds[i]+E[j].w==ds[E[j].to])</div><div class="line">				addroad(i,E[j].to,<span class="number">1</span>);</div><div class="line">			<span class="keyword">if</span>(dt[E[j].to]==dt[i]+E[j].w)</div><div class="line">				addlist(i,E[j].to,<span class="number">0</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> h[N],cur[N];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span>(h));</div><div class="line">	que.push(S),h[S]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(!que.empty())&#123;</div><div class="line">		<span class="keyword">int</span> u=que.front();que.pop();</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> v,i=last[u];i;i=G[i].nxt)&#123;</div><div class="line">			<span class="keyword">if</span>(v=G[i].to,G[i].cap&amp;&amp;h[v]==<span class="number">-1</span>)</div><div class="line">			 h[v]=h[u]+<span class="number">1</span>,que.push(v);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> h[T]!=<span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> low)</span></span>&#123;</div><div class="line">	<span class="keyword">if</span>(u==T||low==<span class="number">0</span>)<span class="keyword">return</span> low;</div><div class="line">	<span class="keyword">int</span> w,used=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> &amp;i=cur[u];i;i=G[i].nxt)&#123;</div><div class="line">		<span class="keyword">if</span>(G[i].cap&amp;&amp;h[G[i].to]==h[u]+<span class="number">1</span>)&#123;</div><div class="line">			w=dfs(G[i].to,min(low-used,G[i].cap));</div><div class="line">			used+=w;</div><div class="line">			G[i].cap-=w,G[i^<span class="number">1</span>].cap+=w;</div><div class="line">			<span class="keyword">if</span>(used==low)<span class="keyword">return</span> low;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(!used)h[u]=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> used;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dinic</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">int</span> tmp=<span class="number">0</span>,tim=<span class="number">2</span>;</div><div class="line">	<span class="keyword">while</span>(bfs()&amp;&amp;tim--)&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cur[i]=last[i];</div><div class="line">		tmp+=dfs(S,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"><span class="comment">//------------------Tarjan-------------------</span></div><div class="line"><span class="keyword">int</span> dfn[N],low[N],dft,st[N],sccon[N],scc,top,size[N];</div><div class="line"><span class="keyword">bool</span> insv[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</div><div class="line">	low[u]=dfn[u]=++dft;</div><div class="line">	insv[u]=<span class="number">1</span>,st[++top]=u;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> v,i=last[u];i;i=G[i].nxt)&#123;</div><div class="line">		<span class="keyword">if</span>(v=G[i].to,G[i].cap==<span class="number">0</span>)<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span>(!dfn[v])Tarjan(v),low[u]=min(low[u],low[v]);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(insv[v])low[u]=min(low[u],dfn[v]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(dfn[u]==low[u])&#123;</div><div class="line">		scc++;<span class="keyword">int</span> v=<span class="number">0</span>;</div><div class="line">		<span class="keyword">while</span>(u!=v)v=st[top--],size[scc]++,insv[v]=<span class="number">0</span>,sccon[v]=scc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">		<span class="keyword">if</span>(!dfn[i])Tarjan(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">//--------------double bfs-------------------</span></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> DS[N],DT[N];</div><div class="line"><span class="keyword">bool</span> markvis[N];</div><div class="line"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; dq;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFSF</span><span class="params">()</span></span>&#123;</div><div class="line">	fill(DS,DS+N,INF);</div><div class="line">	<span class="built_in">memset</span>(markvis,<span class="number">0</span>,<span class="keyword">sizeof</span>(markvis));</div><div class="line">	dq.push_back(S);DS[S]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(!dq.empty())&#123;</div><div class="line">		<span class="keyword">int</span> u=dq.front();dq.pop_front();</div><div class="line">		<span class="keyword">if</span>(markvis[u])<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">else</span> markvis[u]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> v,i=last[u];i;i=G[i].nxt)<span class="keyword">if</span>(v=G[i].to,!(i&amp;<span class="number">1</span>))&#123;</div><div class="line">			DS[v]=min(DS[u]+G[i].w,DS[v]);</div><div class="line">			<span class="keyword">if</span>(G[i].w)dq.push_back(v);</div><div class="line">			<span class="keyword">else</span> dq.push_front(v);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFSS</span><span class="params">()</span></span>&#123;</div><div class="line">	fill(DT,DT+N,INF);</div><div class="line">	<span class="built_in">memset</span>(markvis,<span class="number">0</span>,<span class="keyword">sizeof</span>(markvis));</div><div class="line">	dq.push_back(T);DT[T]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(!dq.empty())&#123;</div><div class="line">		<span class="keyword">int</span> u=dq.front();dq.pop_front();</div><div class="line">		<span class="keyword">if</span>(markvis[u])<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">else</span> markvis[u]=<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> v,i=first[u];i;i=L[i].nxt)&#123;</div><div class="line">			v=L[i].to,DT[v]=min(DT[u]+L[i].w,DT[v]);</div><div class="line">			<span class="keyword">if</span>(L[i].w)dq.push_back(v);</div><div class="line">			<span class="keyword">else</span> dq.push_front(v);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//------------------heap---------------------</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> u,v;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> w;</div><div class="line">	node(<span class="keyword">int</span> u=<span class="number">0</span>,<span class="keyword">int</span> v=<span class="number">0</span>,<span class="keyword">long</span> <span class="keyword">long</span> w=<span class="number">0</span>):u(u),v(v),w(w)&#123;&#125;</div><div class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span>  &lt; (<span class="keyword">const</span> node &amp;rhs)<span class="keyword">const</span>&#123;</div><div class="line">		<span class="keyword">return</span> w&gt;rhs.w;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line">priority_queue&lt;node&gt; heap;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VC[N];</div><div class="line"><span class="keyword">int</span> cut[N];</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans[N];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">		<span class="keyword">if</span>(ds[i]!=INF)VC[DS[i]].push_back(i);</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;scc;++i)&#123;</div><div class="line">		<span class="keyword">int</span> sz=VC[i].size();</div><div class="line">		<span class="keyword">while</span>(!heap.empty()&amp;&amp;DT[heap.top().v]&gt;=DS[T]-i)heap.pop();</div><div class="line">		<span class="keyword">for</span>(RG <span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=sz<span class="number">-1</span>;++j)&#123;</div><div class="line">			<span class="keyword">int</span> u=VC[i][j];</div><div class="line">			<span class="keyword">for</span>(RG <span class="keyword">int</span> k=head[u];k;k=E[k].nxt)</div><div class="line">				<span class="keyword">if</span>(DS[E[k].to]&gt;i&amp;&amp;cut[u]!=E[k].to)</div><div class="line">					heap.push(node(u,E[k].to,ds[u]+E[k].w+dt[E[k].to]));</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(!heap.empty())ans[i]=heap.top().w;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//------------------main---------------------</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//freopen("in.txt","r",stdin);</span></div><div class="line">	read(n),read(m);</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> x,y,z,i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">		read(x),read(y),read(z),addedge(x,y,z);</div><div class="line">	read(S),read(T);</div><div class="line">	dijsktra(S,T,ds),dijsktra(T,S,dt);</div><div class="line">	read(k);</div><div class="line">	<span class="keyword">if</span>(ds[T]==INF)&#123;</div><div class="line">		<span class="keyword">while</span>(k--)<span class="built_in">puts</span>(<span class="string">"Infinity"</span>);<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	createGraph();</div><div class="line">	<span class="keyword">if</span>(dinic()&gt;=<span class="number">2</span>)&#123;</div><div class="line">		<span class="keyword">while</span>(k--)<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ds[T]);<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	Tarjan();</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=tot;i+=<span class="number">2</span>)</div><div class="line">		<span class="keyword">if</span>(!G[i].cap&amp;&amp;sccon[G[i].from]!=sccon[G[i].to])</div><div class="line">			cut[G[i].from]=G[i].to,G[i].w=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=num;i++)</div><div class="line">		<span class="keyword">if</span>(cut[L[i].to]==L[i].from)L[i].w=<span class="number">1</span>;</div><div class="line">	BFSF();BFSS();work();</div><div class="line">	<span class="keyword">for</span>(RG <span class="keyword">int</span> x,y,i=<span class="number">1</span>;i&lt;=k;i++)&#123;</div><div class="line">		read(x),read(y);</div><div class="line">		<span class="keyword">if</span>(cut[x]==y)&#123;</div><div class="line">			<span class="keyword">if</span>(ans[DS[x]])<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans[DS[x]]);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Infinity"</span>);</div><div class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(cut[y]==x)&#123;</div><div class="line">			<span class="keyword">if</span>(ans[DS[y]])<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans[DS[y]]);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Infinity"</span>);</div><div class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(cut[x]!=y&amp;&amp;cut[y]!=x)<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ds[T]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="http://img.blog.csdn.net/20170922115811109?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p><img src="http://img.blog.csdn.net/20170922115823239?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVtb25vaWw=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>


    
    
    

  </section>
</article>
  
    <article class="post no-title">

  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p><center></center></p>
<p><div style="width:90%; text-align:left"><br></div></p>
<p><center><h2>2720: [Violet 5]列队春游</h2><span class="green">Time Limit: </span>5 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>215&nbsp;&nbsp;<span class="green">Solved: </span>152<br>[<a href="submitpage.php?id=2720">Submit</a>][<a href="problemstatus.php?id=2720">Status</a>][<a href="bbs.php?id=2720">Discuss</a>]</center></p><h2>Description</h2><div class="content"><p><img height="837" width="659" alt="" src="http://www.lydsy.com/JudgeOnline/upload/201204/T1des(5).gif"></p><p></p>
<p></p><p></p></div><h2>Input</h2><div class="content"><p><img height="110" width="371" alt="" src="http://www.lydsy.com/JudgeOnline/upload/201204/T1input(5).gif"></p></div><h2>Output</h2><div class="content"><p><img height="0" width="0" alt="" src="http://www.lydsy.com/JudgeOnline/upload/201204/T1output(5).gif"><img height="81" width="640" alt="" src="http://www.lydsy.com/JudgeOnline/upload/201204/T1output(6).gif"></p></div><h2>Sample Input</h2><br><h2>Sample Output</h2><br>    <h2>HINT</h2><p></p>
<p><div class="content"><p></p><p><img height="374" width="585" alt="" src="http://www.lydsy.com/JudgeOnline/upload/201204/T1hint(4).gif"></p><br></div></p><h2>Source</h2><br>            <div class="content"><p></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">int</span> i,n,s,x,c[<span class="number">1001</span>]; </div><div class="line"><span class="keyword">double</span> ans;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;  </div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);   </div><div class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x),c[x]++;n++;  </div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">1000</span>;i++)  </div><div class="line">        <span class="keyword">if</span>(c[i])ans+=<span class="number">1.0</span>*c[i]*n/(n-s),s+=c[i];  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%.2lf\n"</span>,ans);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>考虑对i有贡献的j，<br>j&lt; i则共有s个，<br>j&gt;=i则共有n-s+1个，j必须在i中<br>则共有\( (n-s)! \)种排列，剩余s-1个\( P^{s-1}_n \)种排列。<br>=&gt;\( \frac {C<em>S</em>(n-s)!<em>P^{s-1}_n }{n!}  \) = \( \frac{C</em>S<em>(n-s)!</em>n! }{n!<em>(n-s+1)!} \)<br>=&gt;\( \frac{C</em>S}{n<em>S+1} \)<br>加上自己的贡献：<br>\( \frac{C</em>S}{n<em>s+1}+\)=\( \frac{C</em>S}{n<em>s+1} + \frac{C</em>(n<em>s+1)}{n</em>s+1} \)<br>=&gt;\( \frac{C*(n+1)}{n-s+1} \)</p>
</div>

    
    
    

  </section>
</article>
  
    <article class="post ">

  
  <h2 class="title">
    <a href="/2017/09/25/hello-world/">
      Hello World
    </a>
  </h2>
  
  <time>
    Sep 25, 2017
  </time>
  <section class="content">
	  <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>


    
    
    

  </section>
</article>
  
    <article class="post ">

  
  <h2 class="title">
    <a href="/2017/09/23/刘润达的模拟题/">
      刘润达的模拟题
    </a>
  </h2>
  
  <time>
    Sep 23, 2017
  </time>
  <section class="content">
	  <h1 id="随便做？真的随便做。。。"><a href="#随便做？真的随便做。。。" class="headerlink" title="随便做？真的随便做。。。"></a>随便做？真的随便做。。。</h1><p>难度是逆序的。。。最后一道题贪心总是GG，wyy的code轻松AC，看来我还是太naive了。。贪心的确不行。</p>
<h1 id="随-rand"><a href="#随-rand" class="headerlink" title="随(rand)"></a>随(rand)</h1><p>好题，太难了。。。。</p>
<h2 id="【题目描述】"><a href="#【题目描述】" class="headerlink" title="【题目描述】"></a>【题目描述】</h2><p>给出n 个正整数a1,a2…an 和一个质数mod.一个变量x 初始为1.进行m 次操作.<br>每次在n 个数中随机选一个ai,然后x=x<em>ai%mod.问m 次操作之后x 的取值的期<br>望.<br>答案一定可以表示成a/b 的精确分数形式.a 和b 可能很大,所以只需要输出<br>a</em>(b^(10^9+5))模10^9+7 的结果.</p>
<h2 id="【输入格式】"><a href="#【输入格式】" class="headerlink" title="【输入格式】"></a>【输入格式】</h2><p>第一行三个整数n,m,mod.<br>接下来一行n 个空格隔开的正整数a1,a2…an</p>
<h2 id="【输出格式】"><a href="#【输出格式】" class="headerlink" title="【输出格式】"></a>【输出格式】</h2><p>一行一个整数表示答案</p>
<h2 id="【样例输入】"><a href="#【样例输入】" class="headerlink" title="【样例输入】"></a>【样例输入】</h2><p>2 1 3<br>1 2</p>
<h2 id="【样例输出】"><a href="#【样例输出】" class="headerlink" title="【样例输出】"></a>【样例输出】</h2><p>3</p>
<h2 id="【数据范围】"><a href="#【数据范围】" class="headerlink" title="【数据范围】"></a>【数据范围】</h2><p>第1 个测试点:mod=2<br>第2 个测试点:n=1<br>第3,4,5 个测试点:m&lt;=1000,1&lt;=mod&lt;=300.<br>第6,7,8 个测试点:1&lt;=mod&lt;=300<br>对于全部测试点: 1&lt;=ai&lt;mod,mod 为质数1&lt;=mod&lt;=1000,<br>对于全部测试点:1&lt;=n&lt;=10^5,1&lt;=m&lt;=10^9</p>
<h2 id="【孙金宁教你学数学】"><a href="#【孙金宁教你学数学】" class="headerlink" title="【孙金宁教你学数学】"></a>【孙金宁教你学数学】</h2><p>质数P 的原根g 满足1&lt;=rt&lt;P,且rt 的1 次方,2 次方…(P-1)次方在模P 意义下可<br>以取遍1 到(P-1)的所有整数.<br>欧拉定理:对于质数P,1&lt;=x&lt;P 的任意x 的P-1 次方在模P 意义下都为1.<br>显然,原根的1 次方,2 次方…（P-2）次方在模P 意义下都不为1,只有(P-1)次方在<br>模P 意义下为1.这也是一个数成为原根的充分必要条件.</p>
<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD=<span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100100</span>,MD=<span class="number">1100</span>;</div><div class="line"><span class="keyword">int</span> n,m,mod,r,modt,w[N],num[MD],dm[MD],vis[MD],flag;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[MD][MD],f[MD]=&#123;<span class="number">1</span>&#125;,mtr[MD][MD],g,ans,tmp;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;T flag=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">pow_mod</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> mo)</span></span>&#123;</div><div class="line">  	<span class="keyword">long</span> <span class="keyword">long</span> ret=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>(b)&#123;</div><div class="line">    	<span class="keyword">if</span>(b&amp;<span class="number">1</span>)ret=(ret*a)%mo;</div><div class="line">    	a=(a*a)%mo;b&gt;&gt;=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">  	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">root</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;mod;++i)&#123;</div><div class="line">    	flag=<span class="number">0</span>,tmp=<span class="number">1</span>;</div><div class="line">    	<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;mod;++j)&#123;</div><div class="line">      		tmp=tmp*i%mod;</div><div class="line">			<span class="keyword">if</span>(vis[tmp])&#123;</div><div class="line">				flag=<span class="number">1</span>;<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">      		vis[tmp]=<span class="number">1</span>;</div><div class="line">    	&#125;</div><div class="line">    	<span class="keyword">if</span>(!flag)<span class="keyword">return</span> i;</div><div class="line">  	&#125;</div><div class="line">  	<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//freopen("rand.in","r",stdin);</span></div><div class="line">	<span class="comment">//freopen("rand.out","w",stdout);</span></div><div class="line">	read(n),read(m),read(mod);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)read(w[i]);</div><div class="line">	g=pow_mod(n,MOD<span class="number">-2</span>,MOD),r=root();tmp=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;mod;++i)tmp=tmp*r%mod,dm[tmp]=i;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)++num[dm[w[i]]];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;mod;++i)</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;mod;++j)</div><div class="line">	    	(dp[i][(i+j)%(mod<span class="number">-1</span>)]=dp[i][(i+j)%(mod<span class="number">-1</span>)]+g*num[j]%MOD)%=MOD;</div><div class="line">	<span class="keyword">for</span>(;m;m&gt;&gt;=<span class="number">1</span>)&#123;</div><div class="line">		<span class="comment">/*</span></div><div class="line"><span class="comment">		cout&lt;&lt;"DP:"&lt;&lt;endl;</span></div><div class="line"><span class="comment">		for(register int i=0;i&lt;=mod;++i)&#123;</span></div><div class="line"><span class="comment">			for(register int j=0;j&lt;=mod;++j)</span></div><div class="line"><span class="comment">				printf("%010d ",dp[i][j]);</span></div><div class="line"><span class="comment">			cout&lt;&lt;endl;</span></div><div class="line"><span class="comment">		&#125;cout&lt;&lt;endl;</span></div><div class="line"><span class="comment">		*/</span></div><div class="line">	    <span class="keyword">if</span>(m&amp;<span class="number">1</span>)&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=mod;++i)&#123;</div><div class="line">				mtr[<span class="number">0</span>][i]=<span class="number">0</span>;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=mod;++k)</div><div class="line">					(mtr[<span class="number">0</span>][i]=mtr[<span class="number">0</span>][i]+f[k]*dp[k][i]%MOD)%=MOD;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=mod;++i)f[i]=mtr[<span class="number">0</span>][i];</div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=mod;++i)&#123;</div><div class="line">	    	mtr[<span class="number">0</span>][i]=<span class="number">0</span>;</div><div class="line">	    	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> k=<span class="number">0</span>;k&lt;=mod;++k)</div><div class="line">	        	(mtr[<span class="number">0</span>][i]=mtr[<span class="number">0</span>][i]+dp[<span class="number">0</span>][k]*dp[k][i]%MOD)%=MOD;</div><div class="line">		&#125;</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=mod;++i)dp[<span class="number">0</span>][i]=mtr[<span class="number">0</span>][i];</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=mod;++i)&#123;</div><div class="line">	    	dp[i][<span class="number">0</span>]=dp[i<span class="number">-1</span>][mod<span class="number">-2</span>];</div><div class="line">	    	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> j=<span class="number">1</span>;j&lt;mod<span class="number">-1</span>;++j)dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>];</div><div class="line">	    &#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/*</span></div><div class="line"><span class="comment">	cout&lt;&lt;"ED:"&lt;&lt;endl;</span></div><div class="line"><span class="comment">    cout&lt;&lt;"DP:"&lt;&lt;endl;</span></div><div class="line"><span class="comment">	for(register int i=0;i&lt;=mod;++i)&#123;</span></div><div class="line"><span class="comment">		for(register int j=0;j&lt;=mod;++j)</span></div><div class="line"><span class="comment">			printf("%010d ",dp[i][j]);</span></div><div class="line"><span class="comment">		cout&lt;&lt;endl;</span></div><div class="line"><span class="comment">	&#125;cout&lt;&lt;endl;</span></div><div class="line"><span class="comment">	*/</span></div><div class="line">	ans=<span class="number">0</span>,tmp=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=mod;++i)&#123;</div><div class="line">		ans+=tmp*f[i]%MOD,ans%=MOD;</div><div class="line">		tmp=tmp*r%mod;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>考察概率和期望的求解,矩阵乘法,原根的性质,循环矩阵的性质,倍增优化DP.<br>首先需要注意到虽然n可以达到\(10^5\),但相同数字可以合并考虑,只需要考虑mod个不同的数字及选择它们的概率.<br>第1个测试点:mod=2,则n个数字都是1,直接输出1即可.<br>第2个测试点:每次乘上去的数字只有一种选择,快速幂即可.<br>第3,4,5个测试点:定义\(f[i][j]\)表示i次操作后x的数值为j的概率.直接转移,复杂度O\((m<em>mod^2)\)<br>第6,7,8个测试点:第3,4,5个测试点中的DP转移可以转化为矩阵乘法形式,利用矩阵快速幂进行优化,复杂度\(O(mod^3</em>logm)\)<br>第9,10个测试点(标算):利用原根进行转化,则乘法转化为加法,\(f[i][j]\)表示i次操作后x取模后等于原根的j次方的概率.指数需要对\((mod-1)\)取模.这样转化一下我们发现转移还是矩阵的形式,而且是循环矩阵的形式.循环矩阵快速幂,复杂度\(O(mod^2<em>logm)\)<br>另一种标算:定义\(f[i][j]\)表示i次操作后变成原根的j次方的概率.求出\(g[i][j]\)表示2^i次操作后变成原根的j次方的概率.倍增的思想求出\(f[m][]\)这个数组.也是O\((mod^2</em>logm)\)<br>更加优越的算法:本质上我们要做的是循环卷积,可以使用fft.但本题的模数使得fft较为不方便..</p>
<h1 id="便-then"><a href="#便-then" class="headerlink" title="便 then"></a>便 then</h1><p>便(then)</p>
<h2 id="【题目描述】-1"><a href="#【题目描述】-1" class="headerlink" title="【题目描述】"></a>【题目描述】</h2><p>给出一个R<em>C的棋盘.共有R行C列,R</em>C个格子.现要在每个格子都填一个非负整数.使得任意一个2<em>2的正方形区域都满足这样的性质:左上角的数字+右下角的数字=左下角的数字+右上角的数字.有些格子已经确定,你不能更改其中的数字.其他格子的数字由你决定.<br>这是一个符合要求的3</em>3的棋盘:<br>1 2 3<br>2 3 4<br>4 5 6<br>不难验证每个2*2的区域都是符合要求的.<br>Orbitingflea想要知道一个可行的填充棋盘的方案.但是这个方案可能很大.所以你只需对给定的棋盘判定是否存在至少一种可行的填充棋盘的方案.</p>
<h2 id="【输入格式】-1"><a href="#【输入格式】-1" class="headerlink" title="【输入格式】"></a>【输入格式】</h2><p>第一行输入一个T，表示数据组数。接下来T组数据。<br>每组数据的第1行2个整数R,C表示棋盘的大小.<br>第2行1个整数n表示已经被填好数字的格子的数目.<br>接下来n行每行3个整数ri,ci,ai,表示第ri行ci列的格子被填上了数字ai.</p>
<h2 id="【输出格式】-1"><a href="#【输出格式】-1" class="headerlink" title="【输出格式】"></a>【输出格式】</h2><p>T行.第i行是第i组数据的答案.有合法方案时输出一行Yes,没有时输出一行No.</p>
<h2 id="【样例输入】-1"><a href="#【样例输入】-1" class="headerlink" title="【样例输入】"></a>【样例输入】</h2><p>6<br>2 2 3<br>1 1 0<br>1 2 10<br>2 1 20<br>2 3 5<br>1 1 0<br>1 2 10<br>1 3 20<br>2 1 30<br>2 3 40<br>2 2 3<br>1 1 20<br>1 2 10<br>2 1 0<br>3 3 4<br>1 1 0<br>1 3 10<br>3 1 10<br>3 3 20<br>2 2 4<br>1 1 0<br>1 2 10<br>2 1 30<br>2 2 20<br>1 1 1<br>1 1 -1</p>
<h2 id="【样例输出】-1"><a href="#【样例输出】-1" class="headerlink" title="【样例输出】"></a>【样例输出】</h2><p>Yes<br>No<br>No<br>Yes<br>No<br>No</p>
<h2 id="【数据范围】-1"><a href="#【数据范围】-1" class="headerlink" title="【数据范围】"></a>【数据范围】</h2><p>第1个测试点,R=1<br>第2,3个测试点,R*C&lt;=12,如果有解,保证存在一个解使得所有数字大小不超过2<br>第4,5个测试点,R=2<br>第6,7个测试点,R=3<br>第8个测试点,1&lt;=R,C&lt;=20<br>第9个测试点,1&lt;=R,C&lt;=100<br>对于全部测试点,1&lt;=T&lt;=6,1&lt;=R,C,n&lt;=100000,1&lt;=ri&lt;=R,1&lt;=ci&lt;=C,同一个格子不会多次被填上数字.ai是整数且绝对值不超过10^9.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;T flag=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> R,C,n,flag,T;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> fa[N][<span class="number">2</span>],w[N][<span class="number">2</span>],val[N][<span class="number">2</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">data</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> x,y;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> val;</div><div class="line">	data()&#123;&#125;</div><div class="line">	data(<span class="keyword">int</span> _x,<span class="keyword">int</span> _y,<span class="keyword">long</span> <span class="keyword">long</span> _val):x(_x),y(_y),val(_val)&#123;&#125;</div><div class="line">&#125;a[N];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpf</span><span class="params">(data a,data b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.x&lt;b.x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmps</span><span class="params">(data a,data b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.y&lt;b.y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">bool</span> d)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(fa[x][d]==x)<span class="keyword">return</span> fa[x][d];</div><div class="line">    <span class="keyword">int</span> tmp=find(fa[x][d],d);</div><div class="line">    w[x][d]+=w[fa[x][d]][d];</div><div class="line">    <span class="keyword">return</span> fa[x][d]=tmp;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cntval</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">long</span> <span class="keyword">long</span> l,<span class="keyword">bool</span> d)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> xt=find(x,d),yt=find(y,d);</div><div class="line">    <span class="keyword">if</span>(xt==yt)<span class="keyword">return</span> w[x][d]==l+w[y][d];</div><div class="line">    fa[xt][d]=yt;</div><div class="line">    w[xt][d]=l-w[x][d]+w[y][d];</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"then.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"then.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">    read(T);</div><div class="line">    <span class="keyword">while</span>(T--)&#123;</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=N<span class="number">-2</span>;i++)fa[i][<span class="number">0</span>]=fa[i][<span class="number">1</span>]=i;</div><div class="line">	    <span class="built_in">memset</span>(w,<span class="number">0</span>,<span class="keyword">sizeof</span>(w)),<span class="built_in">memset</span>(val,<span class="number">127</span>/<span class="number">2</span>,<span class="keyword">sizeof</span>(val));</div><div class="line">	    read(R),read(C),read(n),flag=<span class="number">1</span>;</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> x,y,z,i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">	        read(x),read(y),read(z);</div><div class="line">	        a[i]=data(x,y,z);</div><div class="line">	        <span class="keyword">if</span>(z&lt;<span class="number">0</span>)flag=<span class="number">0</span>;</div><div class="line">	        <span class="keyword">if</span>((R*C)&lt;=<span class="number">12</span>&amp;&amp;R!=<span class="number">1</span>&amp;&amp;z&gt;=<span class="number">3</span>)flag=<span class="number">0</span>;<span class="comment">// 过了数据过不了样例</span></div><div class="line">	    &#125;</div><div class="line">	    <span class="keyword">if</span>(!flag)&#123;</div><div class="line">	    	<span class="built_in">printf</span>(<span class="string">"No\n"</span>);</div><div class="line">	    	<span class="keyword">continue</span>;</div><div class="line">	    &#125;</div><div class="line">	    sort(a+<span class="number">1</span>,a+n+<span class="number">1</span>,cmpf);</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">			<span class="keyword">if</span>(a[i].x==a[i+<span class="number">1</span>].x&amp;&amp;!cntval(a[i].y,a[i+<span class="number">1</span>].y,a[i+<span class="number">1</span>].val-a[i].val,<span class="number">1</span>))&#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"No\n"</span>);flag=<span class="number">0</span>;<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span>(!flag)<span class="keyword">continue</span>;</div><div class="line">	    sort(a+<span class="number">1</span>,a+n+<span class="number">1</span>,cmps);</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">			<span class="keyword">if</span>(a[i].y==a[i+<span class="number">1</span>].y&amp;&amp;!cntval(a[i].x,a[i+<span class="number">1</span>].x,a[i+<span class="number">1</span>].val-a[i].val,<span class="number">0</span>))&#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"No\n"</span>);flag=<span class="number">0</span>;<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">if</span>(!flag)<span class="keyword">continue</span>;</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">	        val[find(a[i].x,<span class="number">0</span>)][<span class="number">0</span>]=min(val[find(a[i].x,<span class="number">0</span>)][<span class="number">0</span>],a[i].val+w[a[i].x][<span class="number">0</span>]);</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=R;i++)</div><div class="line">	        val[find(i,<span class="number">0</span>)][<span class="number">1</span>]=min(val[find(i,<span class="number">0</span>)][<span class="number">1</span>],-w[i][<span class="number">0</span>]);</div><div class="line">	    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=R;i++)</div><div class="line">	        <span class="keyword">if</span>(fa[i][<span class="number">0</span>]==i&amp;&amp;val[i][<span class="number">1</span>]+val[i][<span class="number">0</span>]&lt;<span class="number">0</span>)&#123;</div><div class="line">	        	<span class="built_in">printf</span>(<span class="string">"No\n"</span>);flag=<span class="number">0</span>;<span class="keyword">break</span>;</div><div class="line">	        &#125;</div><div class="line">	    <span class="keyword">if</span>(!flag)<span class="keyword">continue</span>;</div><div class="line">	    <span class="built_in">printf</span>(<span class="string">"Yes\n"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">6</span></div><div class="line"><span class="comment">2 2 3</span></div><div class="line"><span class="comment">1 1 0</span></div><div class="line"><span class="comment">1 2 10</span></div><div class="line"><span class="comment">2 1 20</span></div><div class="line"><span class="comment">2 3 5</span></div><div class="line"><span class="comment">1 1 0</span></div><div class="line"><span class="comment">1 2 10</span></div><div class="line"><span class="comment">1 3 20</span></div><div class="line"><span class="comment">2 1 30</span></div><div class="line"><span class="comment">2 3 40</span></div><div class="line"><span class="comment">2 2 3</span></div><div class="line"><span class="comment">1 1 20</span></div><div class="line"><span class="comment">1 2 10</span></div><div class="line"><span class="comment">2 1 0</span></div><div class="line"><span class="comment">3 3 4</span></div><div class="line"><span class="comment">1 1 0</span></div><div class="line"><span class="comment">1 3 10</span></div><div class="line"><span class="comment">3 1 10</span></div><div class="line"><span class="comment">3 3 20</span></div><div class="line"><span class="comment">2 2 4</span></div><div class="line"><span class="comment">1 1 0</span></div><div class="line"><span class="comment">1 2 10</span></div><div class="line"><span class="comment">2 1 30</span></div><div class="line"><span class="comment">2 2 20</span></div><div class="line"><span class="comment">1 1 1</span></div><div class="line"><span class="comment">1 1 -1 </span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>考察并查集的应用.<br>第1个测试点:只有1行,无法形成2*2的区域,只要输入的数字中没有负数就一定有解.接下来我们默认已经排除了输入的数字有负数的情况.<br>第2,3个测试点:3^12枚举所有可能的情况.<br>第4,5个测试点:仔细观察一下性质.(1,1)+(2,2)=(1,2)+(2,1),实际上是(1,1)-(2,1)=(1,2)-(2,2).<br>也就是说:对于任意一列,两行之间的差相等.<br>如果不存在填满了数字的一列:这个差我们可以随便确定,比如说让两行之间的差为0.这样一定有解.<br>如果存在填满了数字的一列,我们就可以确定这个差.然后去填充可以填充的数字,只要没有矛盾,不会推导出负数,就一定有解.<br>如果有两列都填满但是得到的两行的差不相等,则无解.<br>第6,7个测试点:3行的情况比2行的情况复杂,如果手动讨论不同行之间的情况,似乎是比较麻烦的,可能会有同学写出来.<br>第8,9个测试点:坐标范围较小,但我没有想到对应的方法,可能会有选手想到针对性的算法.<br>第10个测试点(标算):<br>“对于任意一列,两行之间的差相等”是一个很重要的性质.这告诉我们:每一列差分后得到的结果相同.每一行差分后的结果也相同.于是我们对行列分别用带权并查集维护行之间,列之间的差分关系.如果差分关系出现矛盾(两行之间的差值可以推导出两种可能)则无解.如果差分关系没有矛盾,则需要求出整个矩阵中能推导出的最小值判断是否小于0.这里的推导方法是:维护差分关系的并查集必然分成了多个连通块.一种直观的方法是,枚举一个关于行的连通块,再枚举一个关于列的连通块,这两个连通块相交产生的格子中的最小值位于列和行的最小值的交点.这样的时间复杂度是很高的.实际上我们只需考虑每个关于列的连通块.对于一个关于列的连通块,我们求出这个连通块中数值最小的一列.考虑这个连通块中所有的已知数字,每个已知数字都可以求出数值最小的一列中某一个数值.在这些数值中取最小值即可,实现的时候,只需用每个已知数字求出这个连通块中某一列的最小值,再从这一列的最小值转换到最小的一列的最小值.</p>
<h1 id="做-do"><a href="#做-do" class="headerlink" title="做(do)"></a>做(do)</h1><p>【题目描述】<br>你是一个位于无限大二维平面上没有近战能力的膜法师,无限大二维平面上还有一个只有近战能力的香港记者.<br>你们都在整点上.每个回合你先行动,香港记者后行动.<br>香港记者的目标是使你被续.你的目标是让香港记者被续.<br>香港记者有一个属性是森破值,当他的森破值小于等于零他将立刻被续.<br>因为香港记者的近战能力比你高到不知道哪里去了,如果任意时刻你和香港记者位于同一个整点,你将立即被续.<br>人物(膜法师或香港记者)被续之后就被得罪了一下,从二维平面上消失了.<br>香港记者只有一种行动模式:移动,香港记者因为跑得比谁都快,一个回合可以移动两次.每次可以在上下左右四个方向中选一个移动一步.当然也可以选择不动.也就是说,一个回合内香港记者可以到达曼哈顿距离小于等于2的任意位置.<br>你在回合中可以在3种操作中选一种:<br>1.移动,你一个回合只能移动1次. 也就是说,一个回合内你可以到达曼哈顿距离小于等于1的任意位置.<br>2.膜.大呼”蛤蛤蛤”,消耗a点膜法值.对香港记者造成伤害.香港记者的森破值会减小,减小的量等于你与香港记者之间的欧几里得距离的平方.即,若你在(x1,y1),香港记者在(x2,y2),香港记者的森破值将减少(x1-x2)^2+(y1-y2)^2.膜法值不足a则不能膜.<br>3.念诗.大呼”苟利国家生死以,竹外桃花三两枝”,回复b点膜法值.<br>一开始你有c点膜法值.之后你的膜法值可以超过c.<br>香港记者有一个好,脑子转得比谁都快,会选择最优策略.<br>如果你会被续,输出”SIMPLE”,如果香港记者会被续,输出“NAIVE”<br>多组数据.</p>
<h2 id="【输入格式】-2"><a href="#【输入格式】-2" class="headerlink" title="【输入格式】"></a>【输入格式】</h2><p>第一行一个正整数T表示数据组数<br>第二行两个空格隔开的整数a,b,含义见【题目描述】.<br>接下来T行,每行描述一组数据.这T行每行为6个空格隔开的整数<br>X1,Y1,X2,Y2,c,d.<br>表示你的初始坐标是(X1,Y1),香港记者的初始坐标是(X2,Y2).你一开始有c点膜法值,香港记者一开始有d点森破值.</p>
<h2 id="【输出格式】-2"><a href="#【输出格式】-2" class="headerlink" title="【输出格式】"></a>【输出格式】</h2><p>T行,一行一个字符串”SIMPLE”或者“NAIVE”.</p>
<h2 id="【样例输入】-2"><a href="#【样例输入】-2" class="headerlink" title="【样例输入】"></a>【样例输入】</h2><p>2<br>2 1<br>0 0 10 10 0 10000<br>0 0 10 10 0 10</p>
<h2 id="【样例输出】-2"><a href="#【样例输出】-2" class="headerlink" title="【样例输出】"></a>【样例输出】</h2><p>SIMPLE<br>NAIVE</p>
<h2 id="【数据范围】-2"><a href="#【数据范围】-2" class="headerlink" title="【数据范围】"></a>【数据范围】</h2><p>第1个测试点,1&lt;=|X1-X2|+|Y1-Y2|&lt;=6<br>第2个测试点,1&lt;=|X1-X2|+|Y1-Y2|&lt;=7<br>第3个测试点,1&lt;=|X1-X2|+|Y1-Y2|&lt;=8<br>第4,5个测试点,a=0<br>第6,7个测试点,b=0<br>100%的数据,T=10^5.1&lt;=X1,X2,Y1,Y2&lt;=10^9<br>|X1-X2|&lt;=300,|Y1-Y2|&lt;=300<br>0&lt;=a,b,c&lt;=100</p>
<h2 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h2><p>暴力踩标程。。。。。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> t,a,b,c,d,elderx,eldery,reporterx,reportery;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;<span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">res</span>)&#123;</span></div><div class="line">	<span class="keyword">static</span> <span class="keyword">char</span> ch;T flag=<span class="number">1</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)<span class="keyword">if</span>(ch==<span class="string">'-'</span>)flag=<span class="number">-1</span>;res=ch<span class="number">-48</span>;</div><div class="line">	<span class="keyword">while</span>((ch=getchar())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)res=res*<span class="number">10</span>+ch<span class="number">-48</span>;res*=flag;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	freopen(<span class="string">"do.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"do.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	read(t),read(a),read(b);</div><div class="line">	<span class="keyword">while</span>(t--)&#123;</div><div class="line">		read(elderx),read(eldery),read(reporterx),read(reportery),read(c),read(d);</div><div class="line">		<span class="keyword">int</span> x=<span class="built_in">abs</span>(elderx-reporterx),y=<span class="built_in">abs</span>(eldery-reportery);</div><div class="line">		<span class="keyword">for</span>(;;)&#123;</div><div class="line">			<span class="keyword">if</span>(c&lt;a)c+=b;</div><div class="line">			<span class="keyword">else</span> d-=x*x+y*y,c-=a;</div><div class="line">			<span class="keyword">if</span>(d&gt;<span class="number">0</span>)<span class="keyword">if</span>(x &gt;= y+<span class="number">2</span>)x-=<span class="number">2</span>;</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(y&gt;=x+<span class="number">2</span>)y-=<span class="number">2</span>;</div><div class="line">				<span class="keyword">else</span> x--,y--;</div><div class="line">			<span class="keyword">else</span>&#123;<span class="built_in">printf</span>(<span class="string">"NAIVE\n"</span>);<span class="keyword">break</span>;&#125;</div><div class="line">			<span class="keyword">if</span>(x&lt;=<span class="number">0</span>&amp;&amp;y&lt;=<span class="number">0</span>)&#123;<span class="built_in">printf</span>(<span class="string">"SIMPLE\n"</span>);<span class="keyword">break</span>;&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>考察简单的搜索和动态规划,以及分析题目性质的能力<br>首先香港记者必然朝着靠近膜法师的方向移动,那么有3种走法: （横1纵1)（横2）（纵2）<br>前3个测试点:数据范围较小,容易想到搜索.不同的数据范围对应优化程度不同的搜索,对性质的不同程度的分析.<br>这里介绍较为优秀的算法:<br>实际上膜法师如果移动的话,必然不是最优解.在膜法师移动一步之后,香港记者可以移动两步,这时两人的膜法值,森破值都没有变,膜法师白白把自己和香港记者之间的距离缩小了一格(显然两人距离越远对膜法师越有利).<br>因此最优解中膜法师必然停留在原地攻击香港记者.在没有足够的膜法值时就念诗.我们搜索香港记者的最优行走方式即可.<br>同时也发现最终答案和具体坐标无关,只和横纵坐标之差的绝对值有关.而坐标之差,初始膜法值确定时,膜法师在被香港记者续掉之前能够给香港记者造成的伤害也是确定的.预处理一下即可,<br>第4,5,6,7个测试点:思路和标算相同,但因为补充膜法值的操作没有意义,可以简化实现.<br>标算:f[i][j][k]表示两人坐标之差为(i,j),膜法师还有k的膜法值,在香港记者走到膜法师的位置之前,最多能对香港记者造成多少伤害.决策时香港记者需要选择接下来受到伤害最小的走法.<br>预处理f数组后每组询问可以O(1)回答.</p>


    
    
    
	  <div class="tags">
      <a class="tag-link" href="/tags/矩阵优化-DP-原根-并查集-贪心/">矩阵优化 DP 原根 并查集 贪心</a>
	  </div>
    

  </section>
</article>
  
</section>


  <nav id="page-nav">
    
    <a class="prev" rel="prev" href="/archives/2017/">
      <span class="icon icon-chevron-left"></span>
      <span class="text">Previous</span>
    </a>
    
    
    <a class="next" rel="next" href="/archives/2017/page/3/">
      <span class="text">Next</span>
      <span class="icon icon-chevron-right"></span>
    </a>
    
  </nav>
  


      <script>setLoadingBarProgress(60);</script>
    </main>
    
    <footer id="footer" class="clearfix">
  
  
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" class="u-search-input" placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/artchen" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/otakism" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
        <a href="https://plus.google.com/+ArtChenOtakism/posts" class="social google"
          target="_blank" rel="external">
          <span class="icon icon-google"></span>
        </a>
      
        <a href="http://weibo.com/otakism/" class="social sina-weibo"
          target="_blank" rel="external">
          <span class="icon icon-sina-weibo"></span>
        </a>
      
    
  </div>
  
  <div>Theme <span class="codename">Typescript</span> designed by <a href="http://rakugaki.me/" target="_blank">Art Chen</a>.</div>
  <div>&copy; <a href="/">PIVIX</a></div>
  
</footer>


    <script>setLoadingBarProgress(80);</script>
    
  </div>

  
<script>
  var disqus_shortname = 'https://lemonoilP.github.io';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>




<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>

<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "google";
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


  <script>setLoadingBarProgress(100);</script>
  
</body>
</html>
